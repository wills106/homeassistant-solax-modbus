import logging
from dataclasses import dataclass
from homeassistant.components.number import NumberEntityDescription
from homeassistant.components.select import SelectEntityDescription
from homeassistant.components.button import ButtonEntityDescription
from .payload import BinaryPayloadBuilder, BinaryPayloadDecoder, Endian
from custom_components.solax_modbus.const import *
from time import time

_LOGGER = logging.getLogger(__name__)

""" ============================================================================================
bitmasks  definitions to characterize inverters, organized by group
these bitmasks are used in entitydeclarations to determine to which inverters the entity applies
within a group, the bits in an entitydeclaration will be interpreted as OR
between groups, an AND condition is applied, so all groups must match.
An empty group (group without active flags) evaluates to True.
example: GEN3 | GEN4 | X1 | X3 | EPS
means:  any inverter of type (GEN3 or GEN4) and (X1 or X3) and (EPS)
An entity can be declared multiple times (with different bitmasks) if the parameters are different for each inverter type
"""

GEN            = 0x0001 # base generation for MIC, PV, AC
GEN2           = 0x0002
GEN3           = 0x0004
GEN4           = 0x0008
SPF            = 0x0010
ALL_GEN_GROUP  = GEN | GEN2 | GEN3 | GEN4 | SPF

X1             = 0x0100
X3             = 0x0200
ALL_X_GROUP    = X1 | X3

PV             = 0x0400 # Needs further work on PV Only Inverters
AC             = 0x0800
HYBRID         = 0x1000
MIC            = 0x2000
ALL_TYPE_GROUP = PV | AC | HYBRID | MIC

EPS            = 0x8000
ALL_EPS_GROUP  = EPS

DCB            = 0x10000 # dry contact box - gen4
ALL_DCB_GROUP  = DCB

MPPT3          = 0x40000
MPPT4          = 0x80000
MPPT6          = 0x100000
MPPT8          = 0x200000
MPPT10         = 0x400000
ALL_MPPT_GROUP = MPPT3 | MPPT4 | MPPT6 | MPPT8 | MPPT10

ALLDEFAULT = 0 # should be equivalent to HYBRID | AC | GEN | GEN2 | GEN3 | GEN4 | X1 | X3

# ======================= end of bitmask handling code =============================================

SENSOR_TYPES = []

# ====================== find inverter type and details ===========================================

async def async_read_serialnr(hub, address):
    res = None
    try:
        inverter_data = await hub.async_read_holding_registers(unit=hub._modbus_addr, address=address, count=5)
        if not inverter_data.isError():
            decoder = BinaryPayloadDecoder.fromRegisters(inverter_data.registers, byteorder=Endian.BIG)
            res = decoder.decode_string(10).decode("ascii")
            hub.seriesnumber = res
    except Exception as ex: _LOGGER.warning(f"{hub.name}: attempt to read firmware failed at 0x{address:x}", exc_info=True)
    if not res: _LOGGER.warning(f"{hub.name}: reading firmware number from address 0x{address:x} failed; other address may succeed")
    _LOGGER.info(f"Read {hub.name} 0x{address:x} firmware number before potential swap: {res}")
    return res

# =================================================================================================

@dataclass
class GrowattModbusButtonEntityDescription(BaseModbusButtonEntityDescription):
    allowedtypes: int = ALLDEFAULT # maybe 0x0000 (nothing) is a better default choice

@dataclass
class GrowattModbusNumberEntityDescription(BaseModbusNumberEntityDescription):
    allowedtypes: int = ALLDEFAULT # maybe 0x0000 (nothing) is a better default choice

@dataclass
class GrowattModbusSelectEntityDescription(BaseModbusSelectEntityDescription):
    allowedtypes: int = ALLDEFAULT # maybe 0x0000 (nothing) is a better default choice

@dataclass
class GrowattModbusSensorEntityDescription(BaseModbusSensorEntityDescription):
    """A class that describes Growatt Modbus sensor entities."""
    allowedtypes: int = ALLDEFAULT # maybe 0x0000 (nothing) is a better default choice
    order16: int = Endian.BIG
    order32: int = Endian.BIG
    unit: int = REGISTER_U16
    register_type: int = REG_HOLDING

# ====================================== Computed value functions  =================================================
def value_function_time_slot_1(initval, descr, datadict):
    def time_to_int(time_str):
        if time_str is None:
            time_str = "00:00"
        hours, minutes = map(int, time_str.split(':'))
        return (hours * 256) + minutes

    results = []

    for i in range(1, 10):
        begin_key = f"time_{i}_begin"
        end_key = f"time_{i}_end"
        enabled_key = f"time_{i}_enabled"
        mode_key = f"time_{i}_mode"

        begin_raw = datadict.get(begin_key, "00:00")
        end_raw = datadict.get(end_key, "00:00")
        enabled = datadict.get(enabled_key, "Disabled")
        mode = datadict.get(mode_key, "Load First")

        begin = time_to_int(begin_raw)
        end = time_to_int(end_raw)

        if enabled == "Enabled":
            begin += 32768
        if mode == "Battery First":
            begin += 8192
        elif mode == "Grid First":
            begin += 16384

        if time_to_int(end_raw) < time_to_int(begin_raw):
            _LOGGER.error(f"Growatt: Time {i} Begin cannot be smaller than Time {i} End")
        else:
            results.append((REGISTER_U16, begin))
            results.append((REGISTER_U16, end))

    return results

##### new def but save the old for safety
def value_function_time_slot_old(initval, descr, datadict):
    def time_to_int(time_str):
        if time_str is None: # If time_x_ entities is disabled.
            time_str = "00:00"  # Assume "00:00" if the time string is None
        hours, minutes = map(int, time_str.split(':'))
        return (hours * 256) + minutes

    time_1_begin = datadict.get('time_1_begin', '00:00')
    time_2_begin = datadict.get('time_2_begin', '00:00')
    time_3_begin = datadict.get('time_3_begin', '00:00')
    time_1_end = datadict.get('time_1_end', '00:00')
    time_2_end = datadict.get('time_2_end', '00:00')
    time_3_end = datadict.get('time_3_end', '00:00')
    time_1_enabled = datadict.get('time_1_enabled', 'Disabled')  # Expecting "Enabled" or "Disabled"
    time_2_enabled = datadict.get('time_2_enabled', 'Disabled')
    time_3_enabled = datadict.get('time_3_enabled', 'Disabled')
    time_1_mode = datadict.get('time_1_mode', 'Load First') # Expecting "Load First", "Battery First", "Grid First"
    time_2_mode = datadict.get('time_2_mode', 'Load First')
    time_3_mode = datadict.get('time_3_mode', 'Load First') 
    _LOGGER.debug(f"DEBUG value_function_time_slot_1 called with: time_1_begin: {time_1_begin}, time_1_end: {time_1_end}, time_1_enabled: {time_1_enabled}, time_1_mode: {time_1_mode}")
    _LOGGER.debug(f"DEBUG value_function_time_slot_1 called with: time_2_begin: {time_2_begin}, time_2_end: {time_2_end}, time_2_enabled: {time_2_enabled}, time_2_mode: {time_2_mode}")
    _LOGGER.debug(f"DEBUG value_function_time_slot_1 called with: time_3_begin: {time_3_begin}, time_3_end: {time_3_end}, time_3_enabled: {time_3_enabled}, time_3_mode: {time_3_mode}")

    # Convert the times from strings to integers for calculation
    time_1_begin = time_to_int(time_1_begin)
    time_2_begin = time_to_int(time_2_begin)
    time_3_begin = time_to_int(time_3_begin)
    time_1_end = time_to_int(time_1_end)
    time_2_end = time_to_int(time_2_end)
    time_3_end = time_to_int(time_3_end)

    if time_1_enabled == 'Enabled': 
        time_1_begin += 32768
    if time_2_enabled == 'Enabled': 
        time_2_begin += 32768
    if time_3_enabled == 'Enabled': 
        time_3_begin += 32768

    if time_1_mode == 'Battery First':
        time_1_begin += 8192
    elif time_1_mode == 'Grid First':
        time_1_begin += 16384
    if time_2_mode == 'Battery First':
        time_2_begin += 8192
    elif time_2_mode == 'Grid First':
        time_2_begin += 16384
    if time_3_mode == 'Battery First':
        time_3_begin += 8192
    elif time_3_mode == 'Grid First':
        time_3_begin += 16384

    # Check if end is smaller than start. Currently only simple check, inverter will ignore if overlapping time slots. 
    if (time_to_int(datadict.get('time_1_end', '00:00')) < time_to_int(datadict.get('time_1_begin', '00:00'))):
        _LOGGER.error(f"Growatt: Time 1 Begin cannot be smaller than Time 1 End")
    elif (time_to_int(datadict.get('time_2_end', '00:00')) < time_to_int(datadict.get('time_2_begin', '00:00'))):
        _LOGGER.error(f"Growatt: Time 2 Begin cannot be smaller than Time 2 End")
    elif (time_to_int(datadict.get('time_3_end', '00:00')) < time_to_int(datadict.get('time_3_begin', '00:00'))):
        _LOGGER.error(f"Growatt: Time 3 Begin cannot be smaller than Time 3 End")
    else:
        # Write to registers
        return [
            (REGISTER_U16, time_1_begin),
            (REGISTER_U16, time_1_end),
            (REGISTER_U16, time_2_begin),
            (REGISTER_U16, time_2_end),
            (REGISTER_U16, time_3_begin),
            (REGISTER_U16, time_3_end),
        ]

def value_function_time_slots_clear_1_4(initval, descr, datadict):
    return [
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
	(REGISTER_U16, 0),
	(REGISTER_U16, 0),
    ]

def value_function_time_slots_clear_5_9(initval, descr, datadict):
    return [
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
        (REGISTER_U16, 0),
    ]
	
def value_function_growatt_gen4time(initval, descr, datadict):
    hours = initval // 256  # Integer division to get the hours (higher 8 bits)
    minutes = initval % 256  # Modulo to get the minutes (lower 8 bits)
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_1_reverse_begin(initval, descr, datadict):
    initval = datadict.get('register_3038', 0) # need to use a read entity to avoid overwriting the select
    initval = initval & 0x1FFF # Remove bits 13-15 using a bitwise AND with 0x1FFF
    hours = initval // 256  # Integer division to get the hours
    minutes = initval % 256  # Modulo to get the minutes
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_2_reverse_begin(initval, descr, datadict):
    initval = datadict.get('register_3040', 0) # need to use a read entity to avoid overwriting the select
    initval = initval & 0x1FFF # Remove bits 13-15 using a bitwise AND with 0x1FFF
    hours = initval // 256  # Integer division to get the hours
    minutes = initval % 256  # Modulo to get the minutes
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_3_reverse_begin(initval, descr, datadict):
    initval = datadict.get('register_3042', 0) # need to use a read entity to avoid overwriting the select
    initval = initval & 0x1FFF # Remove bits 13-15 using a bitwise AND with 0x1FFF
    hours = initval // 256  # Integer division to get the hours
    minutes = initval % 256  # Modulo to get the minutes
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_4_reverse_begin(initval, descr, datadict):
    initval = datadict.get('register_3044', 0)
    initval = initval & 0x1FFF
    hours = initval // 256
    minutes = initval % 256
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_5_reverse_begin(initval, descr, datadict):
    initval = datadict.get('register_3050', 0)
    initval = initval & 0x1FFF
    hours = initval // 256
    minutes = initval % 256
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_6_reverse_begin(initval, descr, datadict):
    initval = datadict.get('register_3052', 0)
    initval = initval & 0x1FFF
    hours = initval // 256
    minutes = initval % 256
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_7_reverse_begin(initval, descr, datadict):
    initval = datadict.get('register_3054', 0)
    initval = initval & 0x1FFF
    hours = initval // 256
    minutes = initval % 256
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_8_reverse_begin(initval, descr, datadict):
    initval = datadict.get('register_3056', 0)
    initval = initval & 0x1FFF
    hours = initval // 256
    minutes = initval % 256
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_9_reverse_begin(initval, descr, datadict):
    initval = datadict.get('register_3058', 0)
    initval = initval & 0x1FFF
    hours = initval // 256
    minutes = initval % 256
    return f"{hours:02}:{minutes:02}"

def value_function_time_slot_1_reverse_enabled(initval, descr, datadict):
    time_1_enabled = datadict.get('register_3038', 0) # need to use a read entity to avoid overwriting the select
    if int(time_1_enabled) & (1 << 15): # Check if bit 15 is set 
        return "Enabled"
    else:
        return "Disabled"

def value_function_time_slot_2_reverse_enabled(initval, descr, datadict):
    time_2_enabled = datadict.get('register_3040', 0) # need to use a read entity to avoid overwriting the select
    if int(time_2_enabled) & (1 << 15): # Check if bit 15 is set 
        return "Enabled"
    else:
        return "Disabled"

def value_function_time_slot_3_reverse_enabled(initval, descr, datadict):
    time_3_enabled = datadict.get('register_3042', 0) # need to use a read entity to avoid overwriting the select
    if int(time_3_enabled) & (1 << 15): # Check if bit 15 is set 
        return "Enabled"
    else:
        return "Disabled"

def value_function_time_slot_4_reverse_enabled(initval, descr, datadict):
    time_4_enabled = datadict.get('register_3044', 0)
    if int(time_4_enabled) & (1 << 15):
        return "Enabled"
    else:
        return "Disabled"

def value_function_time_slot_5_reverse_enabled(initval, descr, datadict):
    time_5_enabled = datadict.get('register_3050', 0)
    if int(time_5_enabled) & (1 << 15):
        return "Enabled"
    else:
        return "Disabled"

def value_function_time_slot_6_reverse_enabled(initval, descr, datadict):
    time_6_enabled = datadict.get('register_3052', 0)
    if int(time_6_enabled) & (1 << 15):
        return "Enabled"
    else:
        return "Disabled"

def value_function_time_slot_7_reverse_enabled(initval, descr, datadict):
    time_7_enabled = datadict.get('register_3054', 0)
    if int(time_7_enabled) & (1 << 15):
        return "Enabled"
    else:
        return "Disabled"

def value_function_time_slot_8_reverse_enabled(initval, descr, datadict):
    time_8_enabled = datadict.get('register_3056', 0)
    if int(time_8_enabled) & (1 << 15):
        return "Enabled"
    else:
        return "Disabled"

def value_function_time_slot_9_reverse_enabled(initval, descr, datadict):
    time_9_enabled = datadict.get('register_3058', 0)
    if int(time_9_enabled) & (1 << 15):
        return "Enabled"
    else:
        return "Disabled"

def value_function_time_slot_1_reverse_mode(initval, descr, datadict):
    time_1_mode = datadict.get('register_3038', 0) # need to use a read entity to avoid overwriting the select
    if int(time_1_mode) & (1 << 14): # Check bit 14 first for "Grid First" (1 << 14)
        return "Grid First"
    elif int(time_1_mode ) & (1 << 13): # Check bit 13 for "Battery First" (1 << 13)
        return "Battery First"
    else: # Default case if neither bit 13 nor bit 14 is set
        return "Load First"

def value_function_time_slot_2_reverse_mode(initval, descr, datadict):
    time_2_mode = datadict.get('register_3040', 0) # need to use a read entity to avoid overwriting the select
    if int(time_2_mode) & (1 << 14): # Check bit 14 first for "Grid First" (1 << 14)
        return "Grid First"
    elif int(time_2_mode ) & (1 << 13): # Check bit 13 for "Battery First" (1 << 13)
        return "Battery First"
    else: # Default case if neither bit 13 nor bit 14 is set
        return "Load First"

def value_function_time_slot_3_reverse_mode(initval, descr, datadict):
    time_3_mode = datadict.get('register_3042', 0) # need to use a read entity to avoid overwriting the select
    if int(time_3_mode) & (1 << 14): # Check bit 14 first for "Grid First" (1 << 14)
        return "Grid First"
    elif int(time_3_mode ) & (1 << 13): # Check bit 13 for "Battery First" (1 << 13)
        return "Battery First"
    else: # Default case if neither bit 13 nor bit 14 is set
        return "Load First"

def value_function_time_slot_4_reverse_mode(initval, descr, datadict):
    time_4_mode = datadict.get('register_3044', 0)
    if int(time_4_mode) & (1 << 14):
        return "Grid First"
    elif int(time_4_mode) & (1 << 13):
        return "Battery First"
    else:
        return "Load First"

def value_function_time_slot_5_reverse_mode(initval, descr, datadict):
    time_5_mode = datadict.get('register_3050', 0)
    if int(time_5_mode) & (1 << 14):
        return "Grid First"
    elif int(time_5_mode) & (1 << 13):
        return "Battery First"
    else:
        return "Load First"

def value_function_time_slot_6_reverse_mode(initval, descr, datadict):
    time_6_mode = datadict.get('register_3052', 0)
    if int(time_6_mode) & (1 << 14):
        return "Grid First"
    elif int(time_6_mode) & (1 << 13):
        return "Battery First"
    else:
        return "Load First"

def value_function_time_slot_7_reverse_mode(initval, descr, datadict):
    time_7_mode = datadict.get('register_3054', 0)
    if int(time_7_mode) & (1 << 14):
        return "Grid First"
    elif int(time_7_mode) & (1 << 13):
        return "Battery First"
    else:
        return "Load First"

def value_function_time_slot_8_reverse_mode(initval, descr, datadict):
    time_8_mode = datadict.get('register_3056', 0)
    if int(time_8_mode) & (1 << 14):
        return "Grid First"
    elif int(time_8_mode) & (1 << 13):
        return "Battery First"
    else:
        return "Load First"

def value_function_time_slot_9_reverse_mode(initval, descr, datadict):
    time_9_mode = datadict.get('register_3058', 0)
    if int(time_9_mode) & (1 << 14):
        return "Grid First"
    elif int(time_9_mode) & (1 << 13):
        return "Battery First"
    else:
        return "Load First"

def value_function_today_s_solar_energy(initval, descr, datadict):
    return  datadict.get('today_s_pv1_solar_energy', 0) + datadict.get('today_s_pv2_solar_energy',0) + datadict.get('today_s_pv3_solar_energy',0) + datadict.get('today_s_pv4_solar_energy',0)

def value_function_combined_battery_power(initval, descr, datadict):
    return  datadict.get('battery_charge_power', 0) - datadict.get('battery_discharge_power',0)

def value_function_combined_bms_current(initval, descr, datadict):
    amp = datadict.get('bms_1_module_2_amp',0)
    if 0 <= amp <= 250:
        result = amp
    elif 6303.5 <= amp <= 6553.5:
        result = round(-1 * (6553.6 - amp), 1)
    else:
        result = 0
    return result
    
def value_function_module_status(initval, descr, datadict):
    scale = {
        1: "Standby",
        2: "Charging",
        3: "Discharging",
        7: "Sleeping",
    }
    return scale.get(initval, str(initval) + " Unknown Status")

def value_function_battery_voltage(initval, descr, datadict):
	bms = datadict.get('bms_monitoring_version', 0)
	if bms == "ZECA":  #Battery system APX HV (ZECA) uses 0.1 scaling factor for battery voltage 
		initval = initval / 10
	else:
		initval = initval / 100
	return initval

def value_function_total_grid_power(initval, descr, datadict):
    return  datadict.get('grid_power_l1', 0) + datadict.get('grid_power_l2', 0) + datadict.get('grid_power_l3', 0)

def value_function_firmware_control_version(initval, descr, datadict):
		fw_ascii = datadict.get('firmware_control_version_ascii', 0)
		fw_ver = datadict.get('firmware_control_version_number', 0)
		fw_ver = f'{fw_ver:04}' # Convert to a 4-digit decimal number
		return f'{fw_ascii}-{fw_ver}'

def value_function_inverter_state(initval, descr, datadict):
    inverter_state = datadict.get('register_3000', 0)
    inverter_state = inverter_state >> 8 # Remove the lower 8 bits by right-shifting by 8 bits
    status_dict = {
        0: "Waiting",
        3: "Fault",
        4: "Flash",
        5: "PV Bat Online",
        6: "Bat Online"
    }
    return status_dict.get(inverter_state)
    
def value_function_run_mode(initval, descr, datadict):
    run_mode = datadict.get('register_3000', 0)
    run_mode = run_mode & 0xFF # Mask out the upper 8 bits, keeping only the lower 8 bits
    run_mode_dict = {
        0: "Standby",
        1: "Normal",
        3: "Fault",
        4: "Flash"
    }
    return run_mode_dict.get(run_mode)

def value_function_inverter_module(initval, descr, datadict):
    hexStr = "{:08x}".format(initval)
    return (''.join(f"{letter}{digit}" for letter, digit in zip("ABDTPUMS", hexStr))).upper()

# ================================= Button Declarations ============================================================

BUTTON_TYPES = [
    GrowattModbusButtonEntityDescription(
        name = "Active Power Not Limited",
        key = "active_power_not_limited",
        register = 3,
        command = 255,
        allowedtypes = ALL_GEN_GROUP,
        icon = "mdi:gauge-full",
    ),
    GrowattModbusButtonEntityDescription(
        name = "Reactive Power Not Limited",
        key = "reactive_power_not_limited",
        register = 4,
        command = 255,
        allowedtypes = ALL_GEN_GROUP,
        icon = "mdi:gauge-full",
    ),
    GrowattModbusButtonEntityDescription(
        name = "Sync RTC",
        key = "sync_rtc",
        register = 45,
        allowedtypes = ALL_GEN_GROUP,
        write_method = WRITE_MULTI_MODBUS,
        icon = "mdi:home-clock",
        value_function = value_function_sync_rtc_ymd,
    ),
    GrowattModbusButtonEntityDescription(
        name = "Update Time Slots",
        key = "time_slot_1",
        register = 3038,
        allowedtypes = HYBRID | GEN4,
        write_method = WRITE_MULTI_MODBUS,
        icon = "mdi:battery-clock",
        value_function = value_function_time_slot_1,
    ),
    GrowattModbusButtonEntityDescription(
        name = "Clear Time Slots 1-4",
        key = "time_slot_clear_1_4",
        register = 3038,
        allowedtypes = HYBRID | GEN4,
        write_method = WRITE_MULTI_MODBUS,
        icon = "mdi:battery-clock",
        value_function = value_function_time_slots_clear_1_4,
    ),
    GrowattModbusButtonEntityDescription(
        name = "Clear Time Slots 5-9",
        key = "time_slot_clear_5-9",
        register = 3050,
        allowedtypes = HYBRID | GEN4,
        write_method = WRITE_MULTI_MODBUS,
        icon = "mdi:battery-clock",
        value_function = value_function_time_slots_clear_5_9,
    ),	
]

# ================================= Number Declarations ============================================================

NUMBER_TYPES = [
    ###
    #
    # Data only number types
    #
    ###

    ###
    #
    #  Normal number types
    #
    ###
    GrowattModbusNumberEntityDescription(
        name = "Active Power Limit",
        key = "active_power_limit",
        register = 3,
        fmt = "i",
        native_min_value = 0,
        native_max_value = 100,
        native_step = 1,
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = ALL_GEN_GROUP,
    ),
    GrowattModbusNumberEntityDescription(
        name = "Reactive Power Limit",
        key = "reactive_power_limit",
        register = 4,
        fmt = "i",
        native_min_value = -100,
        native_max_value = 100,
        native_step = 1,
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = ALL_GEN_GROUP,
    ),
    GrowattModbusNumberEntityDescription(
        name = "Grid Export Limit",
        key = "grid_export_limit",
        register = 123,
        fmt = "i",
        scale = 0.1,
        native_min_value = -100,
        native_max_value = 100,
        native_step = 1,
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = GEN2 | GEN3 | GEN4,
        #entity_category = EntityCategory.CONFIG, #moved under control
        icon = "mdi:transmission-tower-export",
    ),
    # Not documented, source: https://www.photovoltaikforum.com/thread/192228-growatt-sph-modbus-rtu-rj45-pinout-und-register-beschreibung/?postID=3017838#post3017838
    GrowattModbusNumberEntityDescription(
        name = "Load First Battery Minimum SOC",
        key = "load_first_battery_minimum_soc",
        register = 608,
        fmt = "i",
        native_min_value = 10,
        native_max_value = 100,
        native_step = 1,
        native_unit_of_measurement = PERCENTAGE,
        state = "load_first_battery_minimum_soc",
        allowedtypes = GEN3,
        icon = "mdi:battery-sync",
    ),
    GrowattModbusNumberEntityDescription(
        name = "Grid First Discharge Rate",
        key = "grid_first_discharge_rate",
        register = 1070,
        fmt = "i",
        native_min_value = 0, # docs say '0' here
        native_max_value = 100,
        native_step = 1,
        native_unit_of_measurement = PERCENTAGE,
        state = "grid_first_discharge_rate",
        allowedtypes = GEN3,
        icon = "mdi:battery-sync",
    ),
    GrowattModbusNumberEntityDescription(
        name = "Grid First Battery Minimum SOC",
        key = "grid_first_battery_minimum_soc",
        register = 1071,
        fmt = "i",
        native_min_value = 0, # docs say '0' here
        native_max_value = 100,
        native_step = 1,
        native_unit_of_measurement = PERCENTAGE,
        state = "grid_first_battery_minimum_soc",
        allowedtypes = GEN3,
        icon = "mdi:battery-sync",
    ),
    GrowattModbusNumberEntityDescription(
        name = "Battery First Charge Rate",
        key = "battery_first_charge_rate",
        register = 1090,
        fmt = "i",
        native_min_value = 0,
        native_max_value = 100,
        native_step = 1,
        native_unit_of_measurement = PERCENTAGE,
        state = "battery_first_charge_rate",
        allowedtypes = GEN3,
        icon = "mdi:battery-sync",
    ),
    GrowattModbusNumberEntityDescription(
        name = "Battery First Maximum SOC",
        key = "battery_first_maximum_soc",
        register = 1091,
        fmt = "i",
        native_min_value = 0,
        native_max_value = 100,
        native_step = 1,
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = GEN3,
        icon = "mdi:battery-sync",
    ),
    GrowattModbusNumberEntityDescription(
        name = "EMS Discharging Rate",
        key = "ems_discharging_rate",
        register = 3036,
        unit = REGISTER_U16,
        native_min_value = 0,
        native_max_value = 100,
        native_step = 1,
        fmt = "i",
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = GEN4 | HYBRID,
        write_method = WRITE_SINGLE_MODBUS,
        icon = "mdi:battery-arrow-down",
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.CONFIG,
    ),
    GrowattModbusNumberEntityDescription(
        name = "EMS Discharging Stop SOC (off grid)",
        key = "ems_discharging_stop_soc",
        register = 3037,
        unit = REGISTER_U16,
        native_min_value = 10, #default to avoid complete discharge, documentation says 0.
        native_max_value = 100,
        native_step = 1,
        fmt = "i",
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = GEN4 | HYBRID,
        write_method = WRITE_SINGLE_MODBUS,
        icon = "mdi:battery-10",
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.CONFIG,
    ),
    GrowattModbusNumberEntityDescription(
        name = "EMS Charging Rate",
        key = "ems_charging_rate",
        register = 3047,
        unit = REGISTER_U16,
        native_min_value = 0,
        native_max_value = 100,
        native_step = 1,
        fmt = "i",
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = GEN4 | HYBRID,
        write_method = WRITE_SINGLE_MODBUS,
        icon = "mdi:battery-arrow-up",
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.CONFIG,
    ),
    GrowattModbusNumberEntityDescription(
        name = "EMS Charging Stop SOC",
        key = "ems_charging_stop_soc",
        register = 3048,
        unit = REGISTER_U16,
        native_min_value = 11, #according to shine app.
        native_max_value = 100,
        native_step = 1,
        fmt = "i",
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = GEN4 | HYBRID,
        write_method = WRITE_SINGLE_MODBUS,
        icon = "mdi:battery",
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.CONFIG,
    ),
    GrowattModbusNumberEntityDescription(
        name = "EMS Discharging Stop SOC (on grid)",
        key = "ems_discharging_stop_soc_on_grid",
        register = 3067, #requires newer firmware
        unit = REGISTER_U16,
        native_min_value = 10, #default to avoid complete discharge, documentation says 0.
        native_max_value = 100,
        native_step = 1,
        fmt = "i",
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = GEN4 | HYBRID,
        write_method = WRITE_SINGLE_MODBUS,
        icon = "mdi:battery-10",
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.CONFIG,
    ),
]

# ================================= Select Declarations ============================================================

SELECT_TYPES = [
    ###
    #
    #  Data only select types
    #
    ###

    ###
    #
    #  Normal select types
    #
    ###
    GrowattModbusSelectEntityDescription(
        name = "Inverter Switch",
        key = "inverter_switch",
        register = 0,
        option_dict = {
                0: "Inverter Off",
                1: "Inverter On", },
        allowedtypes = GEN | SPF,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Inverter Switch",
        key = "inverter_switch",
        register = 0,
        option_dict = {
                0: "Inverter Off",
                1: "Inverter On",
                2: "BDC Off",
                3: "BDC On", },
        allowedtypes = GEN2 | GEN3 | GEN4,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Select baud rate",
        key = "select_baud_rate",
        register = 22,
        option_dict = {
                0: "9600bps",
                1: "38400bps", },
        allowedtypes = GEN2 | GEN3 | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Limit Grid Export",
        key = "limit_grid_export",
        register = 122,
        option_dict = {
                0: "Disabled",
                1: "Meter 1",
                2: "Meter 2",
                3: "CT Clamp", },
        allowedtypes = GEN2 | GEN3 | GEN4,
        #entity_category = EntityCategory.CONFIG, #moved under control
        icon = "mdi:transmission-tower-export",
    ),
    ###
    #  Battery First (4-6)
    ###
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 4 Begin",
        key = "battery_first_time_4_begin",
        register = 1017,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 4 End",
        key = "battery_first_time_4_end",
        register = 1018,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 4",
        key = "battery_first_time_4",
        register = 1019,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 5 Begin",
        key = "battery_first_time_5_begin",
        register = 1020,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 5 End",
        key = "battery_first_time_5_end",
        register = 1021,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 5",
        key = "battery_first_time_5",
        register = 1022,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 6 Begin",
        key = "battery_first_time_6_begin",
        register = 1023,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 6 End",
        key = "battery_first_time_6_end",
        register = 1024,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 6",
        key = "battery_first_time_6",
        register = 1025,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),

    ###
    #  Grid First (4-6)
    ###
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 4 Begin",
        key = "grid_first_time_4_begin",
        register = 1026,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 4 End",
        key = "grid_first_time_4_end",
        register = 1027,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 4",
        key = "grid_first_time_4",
        register = 1028,
        option_dict = {
                0: "Disabled",
                1: "Enabled", },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 5 Begin",
        key = "grid_first_time_5_begin",
        register = 1029,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 5 End",
        key = "grid_first_time_5_end",
        register = 1030,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 5",
        key = "grid_first_time_5",
        register = 1031,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 6 Begin",
        key = "grid_first_time_6_begin",
        register = 1032,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 6 End",
        key = "grid_first_time_6_end",
        register = 1033,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 6",
        key = "grid_first_time_6",
        register = 1034,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),



    ###
    #  Grid First (1-3)
    ###
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 1 Begin",
        key = "grid_first_time_1_begin",
        register = 1080,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 1 End",
        key = "grid_first_time_1_end",
        register = 1081,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 1",
        key = "grid_first_time_1",
        register = 1082,
        option_dict = {
                0: "Disabled",
                1: "Enabled", },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 2 Begin",
        key = "grid_first_time_2_begin",
        register = 1083,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 2 End",
        key = "grid_first_time_2_end",
        register = 1084,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 2",
        key = "grid_first_time_2",
        register = 1085,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 3 Begin",
        key = "grid_first_time_3_begin",
        register = 1086,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 3 End",
        key = "grid_first_time_3_end",
        register = 1087,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Grid First Time 3",
        key = "grid_first_time_3",
        register = 1088,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),

    ###
    #  Battery First (1-3)
    ###
    GrowattModbusSelectEntityDescription(
        name = "Battery First Charge From Grid",
        key = "battery_first_charge_from_grid",
        register = 1092,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 1 Begin",
        key = "battery_first_time_1_begin",
        register = 1100,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 1 End",
        key = "battery_first_time_1_end",
        register = 1101,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 1",
        key = "battery_first_time_1",
        register = 1102,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 2 Begin",
        key = "battery_first_time_2_begin",
        register = 1103,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 2 End",
        key = "battery_first_time_2_end",
        register = 1104,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 2",
        key = "battery_first_time_2",
        register = 1105,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 3 Begin",
        key = "battery_first_time_3_begin",
        register = 1106,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 3 End",
        key = "battery_first_time_3_end",
        register = 1107,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Battery First Time 3",
        key = "battery_first_time_3",
        register = 1108,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),

    ###
    #  Load First (1-3)
    ###
    GrowattModbusSelectEntityDescription(
        name = "Load First Time 1 Begin",
        key = "load_first_time_1_begin",
        register = 1110,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Load First Time 1 End",
        key = "load_first_time_1_end",
        register = 1111,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Load First Time 1",
        key = "load_first_time_1",
        register = 1112,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Load First Time 2 Begin",
        key = "load_first_time_2_begin",
        register = 1113,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Load First Time 2 End",
        key = "load_first_time_2_end",
        register = 1114,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Load First Time 2",
        key = "load_first_time_2",
        register = 1115,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Load First Time 3 Begin",
        key = "load_first_time_3_begin",
        register = 1116,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Load First Time 3 End",
        key = "load_first_time_3_end",
        register = 1117,
        option_dict = TIME_OPTIONS_GEN4,
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Load First Time 3",
        key = "load_first_time_3",
        register = 1118,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Priority",
        key = "priority",
        register = 1044,
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First", },
        allowedtypes = GEN3,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:run",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Charger Switch",
        key = "charger_switch",
        register = 3049,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = HYBRID | AC | GEN4,
        #entity_category = EntityCategory.CONFIG, #moved under control
        icon = "mdi:battery-charging",
    ),
    GrowattModbusSelectEntityDescription(
        name = "EPS Switch",
        key = "eps_switch",
        register = 3079,
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        allowedtypes = HYBRID | AC | GEN4 | EPS,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:power-plug-battery",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 1 Begin",
        key = "time_1_begin",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 1 End",
        key = "time_1_end",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 1 Mode",
        key = "time_1_mode",
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 1 Active",
        key = "time_1_enabled",
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 2 Begin",
        key = "time_2_begin",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 2 End",
        key = "time_2_end",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 2 Mode",
        key = "time_2_mode",
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 2 Active",
        key = "time_2_enabled",
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 3 Begin",
        key = "time_3_begin",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 3 End",
        key = "time_3_end",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 3 Mode",
        key = "time_3_mode",
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 3 Active",
        key = "time_3_enabled",
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 4 Begin",
        key = "time_4_begin",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 4 End",
        key = "time_4_end",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 4 Mode",
        key = "time_4_mode",
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 4 Active",
        key = "time_4_enabled",
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),    
    GrowattModbusSelectEntityDescription(
        name = "Time 5 Begin",
        key = "time_5_begin",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 5 End",
        key = "time_5_end",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 5 Mode",
        key = "time_5_mode",
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 5 Active",
        key = "time_5_enabled",
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 6 Begin",
        key = "time_6_begin",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 6 End",
        key = "time_6_end",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 6 Mode",
        key = "time_6_mode",
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 6 Active",
        key = "time_6_enabled",
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 7 Begin",
        key = "time_7_begin",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 7 End",
        key = "time_7_end",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 7 Mode",
        key = "time_7_mode",
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 7 Active",
        key = "time_7_enabled",
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 8 Begin",
        key = "time_8_begin",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 8 End",
        key = "time_8_end",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 8 Mode",
        key = "time_8_mode",
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 8 Active",
        key = "time_8_enabled",
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 9 Begin",
        key = "time_9_begin",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 9 End",
        key = "time_9_end",
        option_dict = TIME_OPTIONS_GEN4,
        write_method = WRITE_DATA_LOCAL,
        unit = REGISTER_U16,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 9 Mode",
        key = "time_9_mode",
        option_dict = {
                0: "Load First",
                1: "Battery First",
                2: "Grid First",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Time 9 Active",
        key = "time_9_enabled",
        option_dict = {
                0: "Disabled",
                1: "Enabled",
            },
        write_method = WRITE_DATA_LOCAL,
        allowedtypes = HYBRID | GEN4,
        entity_category = EntityCategory.CONFIG,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),

    ###
    #
    # SPF Selects
    #
    ###
    GrowattModbusSelectEntityDescription(
        name = "State Power",
        key = "state_power",
        register = 1,
        option_dict = {
                0: "Battery First",
                1: "Solar First",
                2: "Grid First",
            },
        allowedtypes = SPF,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "State Charge",
        key = "state_charge",
        register = 2,
        option_dict = {
                0: "Solar First",
                1: "Solar and Grid",
                2: "Solar Only",
            },
        allowedtypes = SPF,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "PV Input Mode",
        key = "pv_input_mode",
        register = 7,
        option_dict = {
                0: "Independent",
                1: "Parallel",
            },
        allowedtypes = SPF,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "AC Input Mode",
        key = "ac_input_mode",
        register = 8,
        option_dict = {
                0: "APL",
                1: "UPS",
                2: "Gen",
            },
        allowedtypes = SPF,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Output Voltage Type",
        key = "output_voltage_type",
        register = 18,
        option_dict = {
                0: "208",
                1: "230",
                2: "240",
                3: "220",
                4: "100",
                5: "110",
                6: "120",
            },
        allowedtypes = SPF,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Output Frequency Type",
        key = "output_frequency_type",
        register = 19,
        option_dict = {
                0: "50",
                1: "60",
            },
        allowedtypes = SPF,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Overload Restart",
        key = "overload_restart",
        register = 20,
        option_dict = {
                0: "Yes",
                1: "No",
                2: "Switch to UTI",
            },
        allowedtypes = SPF,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Overtemperature Restart",
        key = "overtemperature_restart",
        register = 21,
        option_dict = {
                0: "Yes",
                1: "No",
            },
        allowedtypes = SPF,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSelectEntityDescription(
        name = "Buzzer",
        key = "buzzer",
        register = 22,
        option_dict = {
                0: "Enable",
                1: "Disable",
            },
        allowedtypes = SPF,
        entity_category = EntityCategory.CONFIG,
        icon = "mdi:dip-switch",
    ),
]

# ================================= Sensor Declarations ============================================================

SENSOR_TYPES: list[GrowattModbusSensorEntityDescription] = [
    GrowattModbusSensorEntityDescription(
        key = "inverter_switch",
        register = 0,
        scale = { 0: "Inverter Off",
                  1: "Inverter On", },
        allowedtypes = GEN | SPF,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        key = "inverter_switch",
        register = 0,
        scale = { 0: "Inverter Off",
                  1: "Inverter On",
                  2: "BDC Off",
                  3: "BDC On", },
        allowedtypes = GEN2 | GEN3 | GEN4,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        key = "active_power_limit",
        register = 3,
        allowedtypes = ALL_GEN_GROUP,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        key = "reactive_power_limit",
        register = 4,
        unit = REGISTER_S16,
        allowedtypes = ALL_GEN_GROUP,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Firmware Version",
        key = "firmware_version",
        register = 9,
        unit = REGISTER_STR,
        wordcount = 3,
        allowedtypes = ALL_GEN_GROUP,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        key = "firmware_control_version_ascii",
        register = 12,
        unit = REGISTER_STR,
        wordcount = 2,
        allowedtypes = ALL_GEN_GROUP,
				internal = True,
    ),
	GrowattModbusSensorEntityDescription(
        key = "firmware_control_version_number",
        register = 14,
        allowedtypes = ALL_GEN_GROUP,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Firmware Control Version",
        key = "firmware_control_version",
        value_function = value_function_firmware_control_version,
        allowedtypes = ALL_GEN_GROUP,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Language",
        key = "language",
        register = 15,
        scale = { 0: "Italiano",
                  1: "English",
                  2: "Deutsch",
                  3: "Espanol",
                  4: "Francais",
                  5: "Hanyu",
                  6: "Polski",
                  7: "Portugues",
                  8: "Magyar", },
        allowedtypes = ALL_GEN_GROUP,
        entity_registry_enabled_default = False,
        icon = "mdi:translate-variant",
    ),
    GrowattModbusSensorEntityDescription(
        key = "select_baud_rate",
        register = 22,
        scale = { 0: "9600bps",
                  1: "38400bps", },
        allowedtypes = GEN2 | GEN3 | GEN4,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Serial Number",
        key = "serialnumber",
        register = 23,
        unit = REGISTER_STR,
        wordcount = 5,
        allowedtypes = GEN | GEN2 | GEN3 | SPF,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Inverter Module",
        key = "inverter_module",
        register = 28,
        unit = REGISTER_U32,
        allowedtypes = GEN | GEN3,
        scale = value_function_inverter_module,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "RTC",
        key = "rtc",
        register = 45,
        unit = REGISTER_WORDS,
        wordcount = 6,
        scale = value_function_rtc_ymd,
        allowedtypes = ALL_GEN_GROUP,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:clock",
    ),
    GrowattModbusSensorEntityDescription(
        key = "limit_grid_export",
        register = 122,
        scale = { 0: "Disabled",
                  1: "Meter 1",
                  2: "Meter 2",
                  3: "CT Clamp", },
        allowedtypes = GEN2 | GEN3 | GEN4,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        key = "grid_export_limit",
        register = 123,
        unit = REGISTER_S16,
        scale = 0.1,
        allowedtypes = GEN2 | GEN3 | GEN4,
        internal = True,
    ),

    # Not documented, source: https://www.photovoltaikforum.com/thread/192228-growatt-sph-modbus-rtu-rj45-pinout-und-register-beschreibung/?postID=3017838#post3017838
    GrowattModbusSensorEntityDescription(
        name = "Load First Battery Minimum SOC",
        key = "load_first_battery_minimum_soc",
        native_unit_of_measurement = PERCENTAGE,
        register = 608,
        allowedtypes = GEN3,
        icon = "mdi:battery-sync",
    ),

    ###
    #  Battery First 4-6
    ###
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 4 Begin",
        key = "battery_first_time_4_begin",
        register = 1017,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 4 End",
        key = "battery_first_time_4_end",
        register = 1018,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 4",
        key = "battery_first_time_4",
        register = 1019,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 5 Begin",
        key = "battery_first_time_5_begin",
        register = 1020,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 5 End",
        key = "battery_first_time_5_end",
        register = 1021,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 5",
        key = "battery_first_time_5",
        register = 1022,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 6 Begin",
        key = "battery_first_time_6_begin",
        register = 1023,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 6 End",
        key = "battery_first_time_6_end",
        register = 1024,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 6",
        key = "battery_first_time_6",
        register = 1025,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),

    ###
    #  Grid First (4-6)
    ###
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 4 Begin",
        key = "grid_first_time_4_begin",
        register = 1026,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 4 End",
        key = "grid_first_time_4_end",
        register = 1027,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 4",
        key = "grid_first_time_4",
        register = 1028,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 5 Begin",
        key = "grid_first_time_5_begin",
        register = 1029,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 5 End",
        key = "grid_first_time_5_end",
        register = 1030,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 5",
        key = "grid_first_time_5",
        register = 1031,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 6 Begin",
        key = "grid_first_time_6_begin",
        register = 1032,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 6 End",
        key = "grid_first_time_6_end",
        register = 1033,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 6",
        key = "grid_first_time_6",
        register = 1034,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Type",
        key = "battery_type",
        register = 1048,
        scale = { 0: "Lithium",
                  1: "Lead Acid",
                  2: "Other", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:battery-unknown",
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Set Voltage",
        key = "eps_set_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 1061,
        scale = { 0: "230",
                  1: "208",
                  2: "240" },
        allowedtypes = GEN3 | EPS,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Set Frequency",
        key = "eps_set_frequency",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1062,
        scale = { 0: "50",
                  1: "60", },
        allowedtypes = GEN3 | EPS,
    ),

    ###
    #  Grid First 1-3
    ###
    GrowattModbusSensorEntityDescription(
        name = "Grid First Discharge Rate",
        key = "grid_first_discharge_rate",
        native_unit_of_measurement = PERCENTAGE,
        register = 1070,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-sync",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Battery Minimum SOC",
        key = "grid_first_battery_minimum_soc",
        native_unit_of_measurement = PERCENTAGE,
        register = 1071,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-sync",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 1 Begin",
        key = "grid_first_time_1_begin",
        register = 1080,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 1 End",
        key = "grid_first_time_1_end",
        register = 1081,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 1",
        key = "grid_first_time_1",
        register = 1082,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 2 Begin",
        key = "grid_first_time_2_begin",
        register = 1083,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 2 End",
        key = "grid_first_time_2_end",
        register = 1084,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 2",
        key = "grid_first_time_2",
        register = 1085,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 3 Begin",
        key = "grid_first_time_3_begin",
        register = 1086,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 3 End",
        key = "grid_first_time_3_end",
        register = 1087,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid First Time 3",
        key = "grid_first_time_3",
        register = 1088,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),

    ###
    #  Battery First 1-3
    ###
    GrowattModbusSensorEntityDescription(
        name = "Battery First Charge Rate",
        key = "battery_first_charge_rate",
        native_unit_of_measurement = PERCENTAGE,
        register = 1090,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-sync",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Maximum SOC",
        key = "battery_first_maximum_soc",
        register = 1091,
        native_unit_of_measurement = PERCENTAGE,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-sync",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Charge From Grid",
        key = "battery_first_charge_from_grid",
        register = 1092,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 1 Begin",
        key = "battery_first_time_1_begin",
        register = 1100,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 1 End",
        key = "battery_first_time_1_end",
        register = 1101,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 1",
        key = "battery_first_time_1",
        register = 1102,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 2 Begin",
        key = "battery_first_time_2_begin",
        register = 1103,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 2 End",
        key = "battery_first_time_2_end",
        register = 1104,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 2",
        key = "battery_first_time_2",
        register = 1105,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 3 Begin",
        key = "battery_first_time_3_begin",
        register = 1106,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 3 End",
        key = "battery_first_time_3_end",
        register = 1107,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery First Time 3",
        key = "battery_first_time_3",
        register = 1108,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),

    ###
    #  Load First
    ###
    GrowattModbusSensorEntityDescription(
        name = "Load First Time 1 Begin",
        key = "load_first_time_1_begin",
        register = 1110,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Load First Time 1 End",
        key = "load_first_time_1_end",
        register = 1111,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Load First Time 1",
        key = "load_first_time_1",
        register = 1112,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Load First Time 2 Begin",
        key = "load_first_time_2_begin",
        register = 1113,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Load First Time 2 End",
        key = "load_first_time_2_end",
        register = 1114,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Load First Time 2",
        key = "load_first_time_2",
        register = 1115,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Load First Time 3 Begin",
        key = "load_first_time_3_begin",
        register = 1116,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Load First Time 3 End",
        key = "load_first_time_3_end",
        register = 1117,
        scale = value_function_sofartime,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-clock",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Load First Time 3",
        key = "load_first_time_3",
        register = 1118,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:dip-switch",
    ),

    GrowattModbusSensorEntityDescription(
        name = "Serial Number",
        key = "serialnumber",
        register = 3001,
        unit = REGISTER_STR,
        wordcount = 5,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription( # to refresh number entity
        key = "ems_discharging_rate",
        register = 3036,
        allowedtypes = HYBRID | GEN4,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription( # to refresh number entity
        key = "ems_discharging_stop_soc",
        register = 3037,
        allowedtypes = HYBRID | GEN4,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription( # to refresh number entity
        key = "ems_charging_rate",
        register = 3047,
        allowedtypes = HYBRID | GEN4,
        internal = True, 
    ),
    GrowattModbusSensorEntityDescription( # to refresh number entity
        key = "ems_charging_stop_soc",
        register = 3048,
        allowedtypes = HYBRID | AC | GEN4,
        internal = True, 
    ),
    GrowattModbusSensorEntityDescription(
        key = "charger_switch",
        register = 3049,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = HYBRID | AC | GEN4,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription( # to refresh number entity
        key = "ems_discharging_stop_soc_on_grid",
        register = 3067, #requires newer firmware
        allowedtypes = HYBRID | GEN4,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Type",
        key = "battery_type",
        register = 3070,
        scale = { 0: "Lithium",
                  1: "Lead Acid",
                  2: "Other", },
        allowedtypes = HYBRID | AC | GEN4,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:battery-unknown",
    ),
    GrowattModbusSensorEntityDescription(
        key = "eps_switch",
        register = 3079,
        scale = { 0: "Disabled",
                  1: "Enabled", },
        allowedtypes = HYBRID | AC | GEN4 | EPS,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Set Voltage",
        key = "eps_set_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3080,
        scale = { 0: "230",
                  1: "208",
                  2: "240" },
        allowedtypes = HYBRID | AC | GEN4 | EPS,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Set Frequency",
        key = "eps_set_frequency",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3081,
        scale = { 0: "50",
                  1: "60", },
        allowedtypes = HYBRID | AC | GEN4 | EPS,
    ),

    ###
    #
    # SPF Holding registers
    #
    ###
    GrowattModbusSensorEntityDescription(
        name = "State Power",
        key = "state_power",
        register = 1,
        scale = { 0: "Battery First",
                1: "Solar First",
                2: "Grid First", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "State Charge",
        key = "state_charge",
        register = 2,
        scale = { 0: "Solar First",
                1: "Solar and Grid",
                2: "Solar Only", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Input Mode",
        key = "pv_input_mode",
        register = 7,
        scale = { 0: "Independent",
                  1: "Parallel", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Input Mode",
        key = "ac_input_mode",
        register = 8,
        scale = { 0: "APL",
                  1: "UPS",
                  2: "Gen", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Voltage Type",
        key = "output_voltage_type",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 18,
        scale = { 0: "208",
                  1: "230",
                  2: "240",
                  3: "220",
                  4: "100",
                  5: "110",
                  6: "120", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Frequency Type",
        key = "output_frequency_type",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        state_class = SensorStateClass.MEASUREMENT,
        register = 19,
        scale = { 0: "50",
                  1: "60", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Overload Restart",
        key = "overload_restart",
        register = 20,
        scale = { 0: "Yes",
                  1: "No",
                  2: "Switch to UTI", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Overtemperature Restart",
        key = "overtemperature_restart",
        register = 21,
        scale = { 0: "Yes",
                  1: "No", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Buzzer",
        key = "buzzer",
        register = 22,
        scale = { 0: "Enable",
                  1: "Disable", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Max Charge Current",
        key = "max_charge_current",
        register = 34,
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        allowedtypes = SPF,
        icon = "mdi:current-dc",
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Max AC Charge Current",
        key = "max_ac_charge_current",
        register = 38,
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        allowedtypes = SPF,
        icon = "mdi:current-dc",
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Type",
        key = "battery_type",
        register = 39,
        scale = { 0: "AGM",
                  1: "Flooded",
                  2: "User Defined",
                  3: "Lithium",
                  4: "User Defined 2", },
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    ###
    #
    # Input registers
    #
    ###
    GrowattModbusSensorEntityDescription(
        name = "Run Mode",
        key = "run_mode",
        register = 0,
        scale = { 0: "Waiting",
                  1: "Normal Mode",
                  2: "?",       
                  3: "Permanent Fault Mode" },
        register_type = REG_INPUT,
        allowedtypes = GEN,
        icon = "mdi:run",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power Total",
        key = "pv_power_total",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | GEN2 | GEN3 | GEN4, #GEN4 is to avoid name breaking, has same under "Total PV Power"
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 1",
        key = "pv_voltage_1",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | GEN2 | GEN3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 1",
        key = "pv_current_1",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 4,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | GEN2 | GEN3,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 1",
        key = "pv_power_1",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | GEN2 | GEN3,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 2",
        key = "pv_voltage_2",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 7,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | GEN2 | GEN3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 2",
        key = "pv_current_2",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 8,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | GEN2 | GEN3,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 2",
        key = "pv_power_2",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 9,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | GEN2 | GEN3,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Power",
        key = "output_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 11,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 3",
        key = "pv_voltage_3",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 11,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | ALL_MPPT_GROUP,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 3",
        key = "pv_current_3",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 12,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | ALL_MPPT_GROUP,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Frequency",
        key = "grid_frequency",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        device_class = SensorDeviceClass.FREQUENCY,
        register = 13,
        register_type = REG_INPUT,
        scale = 0.01,
        rounding = 2,
        allowedtypes = GEN,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 3",
        key = "pv_power_3",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 13,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | ALL_MPPT_GROUP,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage",
        key = "inverter_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 14,
        scale = 0.1,
        register_type = REG_INPUT,
        rounding = 1,
        allowedtypes = GEN | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage L1",
        key = "grid_voltage_l1",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 14,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current",
        key = "grid_current",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 15,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current L1",
        key = "grid_current_l1",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 15,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 4",
        key = "pv_voltage_4",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 15,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT4 | MPPT6 | MPPT8 | MPPT10,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power",
        key = "grid_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 16,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power L1",
        key = "grid_power_l1",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 16,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 4",
        key = "pv_current_4",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 16,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT4 | MPPT6 | MPPT8 | MPPT10,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 4",
        key = "pv_power_4",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 17,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT4 | MPPT6 | MPPT8 | MPPT10,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage L2",
        key = "grid_voltage_l2",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 18,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current L2",
        key = "grid_current_l2",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 19,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 5",
        key = "pv_voltage_5",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 19,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT6 | MPPT8 | MPPT10,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power L2",
        key = "grid_power_l2",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 20,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 5",
        key = "pv_current_5",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 20,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT6 | MPPT8 | MPPT10,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 5",
        key = "pv_power_5",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 21,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT6 | MPPT8 | MPPT10,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage L3",
        key = "grid_voltage_l3",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 22,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current L3",
        key = "grid_current_l3",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 23,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 6",
        key = "pv_voltage_6",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 23,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT6 | MPPT8 | MPPT10,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power L3",
        key = "grid_power_l3",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 24,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 6",
        key = "pv_current_6",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 24,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT6 | MPPT8 | MPPT10,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 6",
        key = "pv_power_6",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 25,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT6 | MPPT8 | MPPT10,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Power Generation",
        key = "today_s_power_generation",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 26,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 7",
        key = "pv_voltage_7",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 27,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT8 | MPPT10,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Power Generation",
        key = "total_power_generation",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 28,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 7",
        key = "pv_current_7",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 28,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT8 | MPPT10,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 7",
        key = "pv_power_7",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 29,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT8 | MPPT10,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Work Time",
        key = "total_work_time",
        native_unit_of_measurement = UnitOfTime.SECONDS,
        device_class = SensorDeviceClass.DURATION,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 30,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.5,
        rounding = 1,
        allowedtypes = GEN,
        entity_registry_enabled_default = False,
        icon = "mdi:timelapse",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 8",
        key = "pv_voltage_8",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 31,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT8 | MPPT10,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Inverter Temperature",
        key = "inverter_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 32,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 8",
        key = "pv_current_8",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 32,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT8 | MPPT10,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 8",
        key = "pv_power_8",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 33,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | MPPT8 | MPPT10,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Power",
        key = "output_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 35,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | GEN4,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Frequency",
        key = "grid_frequency",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        device_class = SensorDeviceClass.FREQUENCY,
        register = 37,
        register_type = REG_INPUT,
        scale = 0.01,
        rounding = 2,
        allowedtypes = GEN2 | GEN3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage",
        key = "inverter_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 38,
        scale = 0.1,
        register_type = REG_INPUT,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage L1",
        key = "grid_voltage_l1",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 38,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current",
        key = "grid_current",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 39,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current L1",
        key = "grid_current_l1",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 39,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power",
        key = "grid_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 40,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power L1",
        key = "grid_power_l1",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 40,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage L2",
        key = "grid_voltage_l2",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 42,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current L2",
        key = "grid_current_l2",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 43,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power L2",
        key = "grid_power_l2",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 44,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage L3",
        key = "grid_voltage_l3",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 46,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current L3",
        key = "grid_current_l3",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 47,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV1 Solar Energy",
        key = "today_s_pv1_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 48,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power L3",
        key = "grid_power_l3",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 48,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV1 Solar Energy",
        key = "total_pv1_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 50,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV2 Solar Energy",
        key = "today_s_pv2_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 52,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Power Generation",
        key = "today_s_power_generation",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 53,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV2 Solar Energy",
        key = "total_pv2_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 54,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Power Generation",
        key = "total_power_generation",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 55,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Solar Energy",
        key = "total_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 56,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Work Time",
        key = "total_work_time",
        native_unit_of_measurement = UnitOfTime.SECONDS,
        device_class = SensorDeviceClass.DURATION,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 57,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.5,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:timelapse",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Reactive Power",
        key = "reactive_power",
        native_unit_of_measurement = UnitOfReactivePower.VOLT_AMPERE_REACTIVE,
        device_class = SensorDeviceClass.REACTIVE_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 58,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        allowedtypes = GEN,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV1 Solar Energy",
        key = "today_s_pv1_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 59,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV1 Solar Energy",
        key = "total_pv1_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 61,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV2 Solar Energy",
        key = "today_s_pv2_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 63,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV2 Solar Energy",
        key = "total_pv2_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 65,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV3 Solar Energy",
        key = "today_s_pv3_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 67,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | ALL_MPPT_GROUP,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV3 Solar Energy",
        key = "total_pv3_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 69,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | ALL_MPPT_GROUP,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV4 Solar Energy",
        key = "today_s_pv4_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 71,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT4 | MPPT6 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV4 Solar Energy",
        key = "total_pv4_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 73,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT4 | MPPT6 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV5 Solar Energy",
        key = "today_s_pv5_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 75,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT6 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV5 Solar Energy",
        key = "total_pv5_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 77,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT6 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV6 Solar Energy",
        key = "today_s_pv6_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 79,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT6 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV6 Solar Energy",
        key = "total_pv6_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 81,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT6 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV7 Solar Energy",
        key = "today_s_pv7_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 83,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV7 Solar Energy",
        key = "total_pv7_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 85,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV8 Solar Energy",
        key = "today_s_pv8_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 87,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV8 Solar Energy",
        key = "total_pv8_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 89,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3 | X3 | MPPT8 | MPPT10,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Solar Energy",
        key = "today_s_solar_energy",
        value_function = value_function_today_s_solar_energy,
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        allowedtypes = GEN2 | GEN3,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Solar Energy",
        key = "total_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 91,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Inverter Temperature",
        key = "inverter_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 93,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "IPM Inverter Temperature",
        key = "ipm_inverter_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 94,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Boost Temperature",
        key = "boost_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 95,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN2 | GEN3,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Voltage",
        key = "battery_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 97,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Priority",
        key = "priority",
        register = 118,
        scale = { 0: "Load First",
                  1: "Battery First",
                  2: "Grid First", },
        register_type = REG_INPUT,
        allowedtypes = GEN2 | GEN3 | GEN4,
        icon = "mdi:run",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Type",
        key = "battery_type",
        register = 119,
        scale = { 0: "Lead-Acid",
                  1: "Lithium", },
        register_type = REG_INPUT,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:run",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 3",
        key = "pv_voltage_3",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 120,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | MPPT3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 3",
        key = "pv_current_3",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 121,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | MPPT3,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 3",
        key = "pv_power_3",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 122,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | MPPT3,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV3 Solar Energy",
        key = "today_s_pv3_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 124,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | MPPT3,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV3 Solar Energy",
        key = "total_pv3_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 126,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN | MPPT3,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Run Mode",
        key = "run_mode",
        register = 1000,
        scale = { 0: "Waiting",
                  1: "Self Test",
                  2: "2, ?",          
                  3: "Permanent Fault Mode",
                  4: "Update Mode",
                  5: "PV Bat Online",
                  6: "Bat Online",
                  7: "7, ?",          
                  8: "Normal Mode",
                  9: "Bypass" },
        register_type = REG_INPUT,
        allowedtypes = GEN3,
        icon = "mdi:run",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Discharge Power",
        key = "battery_discharge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        scale = 0.1,
        register = 1009,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        allowedtypes = GEN3,
        icon = "mdi:battery-arrow-down",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Charge Power",
        key = "battery_charge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        scale = 0.1,
        register = 1011,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        allowedtypes = GEN3,
        icon = "mdi:battery-arrow-up-outline",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Combined Power",
        key = "battery_combined_power",
        value_function = value_function_combined_battery_power,
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        allowedtypes = GEN3 | GEN4,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery SOC",
        key = "battery_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        register = 1014,
        register_type = REG_INPUT,
        allowedtypes = GEN3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to User",
        key = "ac_power_to_user",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1015,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to User L1",
        key = "ac_power_to_user_l1",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1017,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to User L2",
        key = "ac_power_to_user_l2",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1018,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to User L3",
        key = "ac_power_to_user_l3",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1019,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to User Total",
        key = "ac_power_to_user_total",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1021,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | X3 | X1,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to Grid",
        key = "ac_power_to_grid",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1023,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to Grid L1",
        key = "ac_power_to_grid_l1",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1025,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to Grid L2",
        key = "ac_power_to_grid_l2",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1026,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to Grid L3",
        key = "ac_power_to_grid_l3",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1027,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Power to Grid Total",
        key = "ac_power_to_grid_total",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1029,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "House Load",
        key = "house_load",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1031,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | X1,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "House Load L1",
        key = "house_load_l1",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1034,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "House Load L2",
        key = "house_load_l2",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1035,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "House Load L3",
        key = "house_load_l3",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1036,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 1,
        rounding = 1,
        allowedtypes = GEN3 | X3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total House Load",
        key = "total_house_load",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1037,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Temperature",
        key = "battery_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1040,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Grid Import",
        key = "today_s_grid_import",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1044,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:home-import-outline",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Grid Import",
        key = "total_grid_import",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1046,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-import-outline",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Grid Export",
        key = "today_s_grid_export",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1048,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:home-export-outline",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Grid Export",
        key = "total_grid_export",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1050,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:home-export-outline",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Battery Output Energy",
        key = "today_s_battery_output_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1052,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:battery-arrow-down",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Battery Output Energy",
        key = "total_battery_output_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1054,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-arrow-down",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Battery Input Energy",
        key = "today_s_battery_input_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1056,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:battery-arrow-up",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Battery Input Energy",
        key = "total_battery_input_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1058,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-arrow-up",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Load",
        key = "today_s_load",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1060,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:transmission-tower",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Load",
        key = "total_load",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1062,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:transmission-tower",
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Frequency",
        key = "eps_frequency",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1067,
        register_type = REG_INPUT,
        scale = 0.01,
        rounding = 2,
        allowedtypes = GEN3 | EPS,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Voltage",
        key = "eps_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 1068,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Current",
        key = "eps_current",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 1069,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Power",
        key = "eps_power",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        register = 1070,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Voltage L1",
        key = "eps_voltage_l1",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 1068,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Current L1",
        key = "eps_current_l1",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 1069,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Power L1",
        key = "eps_power_l1",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        register = 1070,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Voltage L2",
        key = "eps_voltage_l2",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 1072,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Current L2",
        key = "eps_current_l2",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 1073,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Power L2",
        key = "eps_power_l2",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        register = 1074,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Voltage L3",
        key = "eps_voltage_l3",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 1076,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Current L3",
        key = "eps_current_l3",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 1077,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Power L3",
        key = "eps_power_l3",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        register = 1078,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Loading",
        key = "eps_loading",
        native_unit_of_measurement = PERCENTAGE,
        register = 1080,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3 | EPS,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery highest Temperature",
        key = "battery_highest_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1114,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery lowest Temperature",
        key = "battery_lowest_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1115,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "System Electric Energy Today",
        key = "system_electric_energy_today",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1137,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:transmission-tower",
    ),
    GrowattModbusSensorEntityDescription(
        name = "System Electric Energy Total",
        key = "system_electric_energy_total",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1139,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:transmission-tower",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Self Electric Energy Today",
        key = "self_electric_energy_today",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1141,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:transmission-tower",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Self Electric Energy Total",
        key = "self_electric_energy_total",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 1143,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        entity_registry_enabled_default = False,
        icon = "mdi:transmission-tower",
    ),
    GrowattModbusSensorEntityDescription(
        name = "System Power",
        key = "system_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1145,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:home",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Self Power",
        key = "self_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 1147,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN3,
        icon = "mdi:home",
    ),
#####
#
# TL-X TL-XH
#
#####
    GrowattModbusSensorEntityDescription(
        key = "register_3000",
        register = 3000,
        register_type = REG_INPUT,
        allowedtypes = GEN4,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Inverter State",
        key = "inverter_state",
        value_function = value_function_inverter_state,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Run Mode",
        key = "run_mode",
        value_function = value_function_run_mode,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV Power",
        key = "total_pv_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3001,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 1",
        key = "pv_voltage_1",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3003,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 1",
        key = "pv_current_1",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3004,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 1",
        key = "pv_power_1",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3005,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 2",
        key = "pv_voltage_2",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3007,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 2",
        key = "pv_current_2",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3008,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 2",
        key = "pv_power_2",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3009,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 3",
        key = "pv_voltage_3",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3011,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | ALL_MPPT_GROUP,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 3",
        key = "pv_current_3",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3012,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | ALL_MPPT_GROUP,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 3",
        key = "pv_power_3",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3013,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | ALL_MPPT_GROUP,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 4",
        key = "pv_voltage_4",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3015,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | MPPT4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 4",
        key = "pv_current_4",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3016,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | MPPT4,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 4",
        key = "pv_power_4",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3017,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | MPPT4,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power",
        key = "grid_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3023, #is output power
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4 | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power Total",
        key = "total_grid_power_va",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        value_function = value_function_total_grid_power,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Grid Power",
        key = "total_grid_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3023, #is output power
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Frequency",
        key = "grid_frequency",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        device_class = SensorDeviceClass.FREQUENCY,
        register = 3025,
        register_type = REG_INPUT,
        scale = 0.01,
        rounding = 2,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage",
        key = "inverter_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3026,
        scale = 0.1,
        register_type = REG_INPUT,
        rounding = 1,
        allowedtypes = GEN4 | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage L1",
        key = "grid_voltage_l1",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3026,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current",
        key = "grid_current",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3027,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current L1",
        key = "grid_current_l1",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3027,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power VA",
        key = "grid_power_va",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3028,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power L1",
        key = "grid_power_l1",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3028,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage L2",
        key = "grid_voltage_l2",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3030,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current L2",
        key = "grid_current_l2",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3031,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power L2",
        key = "grid_power_l2",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3032,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage L3",
        key = "grid_voltage_l3",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3034,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Current L3",
        key = "grid_current_l3",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3035,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Power L3",
        key = "grid_power_l3",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3036,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Forward Power",
        key = "total_forward_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3041,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Reverse Power",
        key = "total_reverse_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3043,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Load Power",
        key = "total_load_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3045,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Power Generation",
        key = "today_s_power_generation",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3049,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Power Generation",
        key = "total_power_generation",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3051,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Solar Energy",
        key = "total_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3053,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV1 Solar Energy",
        key = "today_s_pv1_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3055,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV1 Solar Energy",
        key = "total_pv1_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3057,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV2 Solar Energy",
        key = "today_s_pv2_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3059,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV2 Solar Energy",
        key = "total_pv2_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3061,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV3 Solar Energy",
        key = "today_s_pv3_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3063,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | ALL_MPPT_GROUP,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV3 Solar Energy",
        key = "total_pv3_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3065,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | ALL_MPPT_GROUP,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Grid Import",
        key = "today_s_grid_import",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3067,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        icon = "mdi:home-import-outline",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Grid Import",
        key = "total_grid_import",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3069,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:home-import-outline",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Grid Export",
        key = "today_s_grid_export",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3071,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        icon = "mdi:home-export-outline",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Grid Export",
        key = "total_grid_export",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3073,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:home-export-outline",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Yield",
        key = "today_s_yield",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3075,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Yield",
        key = "total_yield",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3077,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's PV4 Solar Energy",
        key = "today_s_pv4_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3079,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | MPPT4,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total PV4 Solar Energy",
        key = "total_pv4_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3081,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | MPPT4,
        entity_registry_enabled_default = False,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Solar Energy",
        key = "today_s_solar_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3083,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        icon = "mdi:solar-power",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Inverter Temperature",
        key = "inverter_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3093,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "IPM Inverter Temperature",
        key = "ipm_inverter_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3094,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Boost Temperature",
        key = "boost_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3095,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        key = "bms_monitoring_version",
        register = 3096, #used for battery voltage scaling
        unit = REGISTER_STR,
        wordcount = 2,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Battery Output Energy",
        key = "today_s_battery_output_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3125,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | HYBRID,
        icon = "mdi:battery-arrow-down",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Battery Output Energy",
        key = "total_battery_output_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3127,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-arrow-down",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Battery Input Energy",
        key = "today_s_battery_input_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3129,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | HYBRID,
        icon = "mdi:battery-arrow-up",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Battery Input Energy",
        key = "total_battery_input_energy",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 3131,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-arrow-up",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Work Mode - Priority",
        key = "work_mode_priority",
        register = 3144,
        scale = { 0: "Load First",
                  1: "Battery First",
                  2: "Grid First", },
        register_type = REG_INPUT,
        allowedtypes = GEN4,
        icon = "mdi:run",
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Frequency",
        key = "eps_frequency",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3145,
        register_type = REG_INPUT,
        scale = 0.01,
        rounding = 2,
        allowedtypes = GEN4 | EPS,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Voltage",
        key = "eps_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3146,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Voltage L1",
        key = "eps_voltage_l1",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3146,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Current",
        key = "eps_current",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3147,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Current L1",
        key = "eps_current_l1",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3147,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Power",
        key = "eps_power",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        register = 3148,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X1,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Power L1",
        key = "eps_power_l1",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        register = 3148,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),GrowattModbusSensorEntityDescription(
        name = "EPS Voltage L2",
        key = "eps_voltage_l2",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3150,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Current L2",
        key = "eps_current_l2",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3151,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Power L2",
        key = "eps_power_l2",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        register = 3152,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Voltage L3",
        key = "eps_voltage_l3",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3154,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Current L3",
        key = "eps_current_l3",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3155,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Power L3",
        key = "eps_power_l3",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        register = 3156,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Total Power",
        key = "eps_total_power",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        register = 3158,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | EPS | X3,
    ),
    GrowattModbusSensorEntityDescription(
        name = "EPS Loading",
        key = "eps_loading",
        native_unit_of_measurement = PERCENTAGE,
        register = 3160,
        register_type = REG_INPUT,
        allowedtypes = GEN4 | EPS,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Voltage",
        key = "battery_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 3169,
        register_type = REG_INPUT,
        scale = value_function_battery_voltage, #due to different scaling factor depending on battery system, default scale 0.01
        rounding = 2,
        allowedtypes = GEN4 | HYBRID,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Current",
        key = "battery_current",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 3170,
        register_type = REG_INPUT,
        unit = REGISTER_S16,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | HYBRID,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery SOC",
        key = "battery_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        register = 3171,
        register_type = REG_INPUT,
        allowedtypes = GEN4 | HYBRID,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Discharge Power",
        key = "battery_discharge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3178,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | HYBRID,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Charge Power",
        key = "battery_charge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3180,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = GEN4 | HYBRID,
    ),
    # TL-XH GEN3 load/battery/grid first priority 
    GrowattModbusSensorEntityDescription(
        key = "register_3038",
        register = 3038,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),  
    GrowattModbusSensorEntityDescription(
        key = "register_3040",
        register = 3040,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),  
    GrowattModbusSensorEntityDescription(
        key = "register_3042",
        register = 3042,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),  
		GrowattModbusSensorEntityDescription(
        key = "register_3044",
        register = 3044,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),  
    GrowattModbusSensorEntityDescription(
        key = "register_3050",
        register = 3050,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),  
    GrowattModbusSensorEntityDescription(
        key = "register_3052",
        register = 3052,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),  
    GrowattModbusSensorEntityDescription(
        key = "register_3054",
        register = 3054,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),  
    GrowattModbusSensorEntityDescription(
        key = "register_3056",
        register = 3056,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),  
    GrowattModbusSensorEntityDescription(
        key = "register_3058",
        register = 3058,
        allowedtypes = GEN4 | HYBRID,
        internal = True,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 1 Begin (read)",
        key = "time_1_begin_read",
        value_function = value_function_time_slot_1_reverse_begin,
        allowedtypes = GEN4 | HYBRID,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 1 Mode (read)",
        key = "time_1_mode_read",
        value_function = value_function_time_slot_1_reverse_mode,
        allowedtypes = GEN4 | HYBRID,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 1 Active (read)",
        key = "time_1_enabled_read",
        value_function = value_function_time_slot_1_reverse_enabled,
        allowedtypes = GEN4 | HYBRID,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 1 End (read)",
        key = "time_1_end_read",
        register = 3039,
        scale = value_function_growatt_gen4time,
        allowedtypes = GEN4 | HYBRID,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 2 Begin (read)",
        key = "time_2_begin_read",
        value_function = value_function_time_slot_2_reverse_begin,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 2 Mode (read)",
        key = "time_2_mode_read",
        value_function = value_function_time_slot_2_reverse_mode,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 2 Active (read)",
        key = "time_2_enabled_read",
        value_function = value_function_time_slot_2_reverse_enabled,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 2 End (read)",
        key = "time_2_end_read",
        register = 3041,
        scale = value_function_growatt_gen4time,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 3 Begin (read)",
        key = "time_3_begin_read",
        value_function = value_function_time_slot_3_reverse_begin,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 3 Mode (read)",
        key = "time_3_mode_read",
        value_function = value_function_time_slot_3_reverse_mode,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 3 Active (read)",
        key = "time_3_enabled_read",
        value_function = value_function_time_slot_3_reverse_enabled,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 3 End (read)",
        key = "time_3_end_read",
        register = 3043,
        scale = value_function_growatt_gen4time,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 4 Begin (read)",
        key = "time_4_begin_read",
        value_function = value_function_time_slot_4_reverse_begin,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 4 Mode (read)",
        key = "time_4_mode_read",
        value_function = value_function_time_slot_4_reverse_mode,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 4 Active (read)",
        key = "time_4_enabled_read",
        value_function = value_function_time_slot_4_reverse_enabled,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 4 End (read)",
        key = "time_4_end_read",
        register = 3045,
        scale = value_function_growatt_gen4time,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),    
    GrowattModbusSensorEntityDescription(
        name = "Time 5 Begin (read)",
        key = "time_5_begin_read",
        value_function = value_function_time_slot_5_reverse_begin,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 5 Mode (read)",
        key = "time_5_mode_read",
        value_function = value_function_time_slot_5_reverse_mode,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 5 Active (read)",
        key = "time_5_enabled_read",
        value_function = value_function_time_slot_5_reverse_enabled,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 5 End (read)",
        key = "time_5_end_read",
        register = 3051,
        scale = value_function_growatt_gen4time,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),    
    GrowattModbusSensorEntityDescription(
        name = "Time 6 Begin (read)",
        key = "time_6_begin_read",
        value_function = value_function_time_slot_6_reverse_begin,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 6 Mode (read)",
        key = "time_6_mode_read",
        value_function = value_function_time_slot_6_reverse_mode,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 6 Active (read)",
        key = "time_6_enabled_read",
        value_function = value_function_time_slot_6_reverse_enabled,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 6 End (read)",
        key = "time_6_end_read",
        register = 3053,
        scale = value_function_growatt_gen4time,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),    
    GrowattModbusSensorEntityDescription(
        name = "Time 7 Begin (read)",
        key = "time_7_begin_read",
        value_function = value_function_time_slot_7_reverse_begin,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 7 Mode (read)",
        key = "time_7_mode_read",
        value_function = value_function_time_slot_7_reverse_mode,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 7 Active (read)",
        key = "time_7_enabled_read",
        value_function = value_function_time_slot_7_reverse_enabled,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 7 End (read)",
        key = "time_7_end_read",
        register = 3055,
        scale = value_function_growatt_gen4time,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),    
    GrowattModbusSensorEntityDescription(
        name = "Time 8 Begin (read)",
        key = "time_8_begin_read",
        value_function = value_function_time_slot_8_reverse_begin,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 8 Mode (read)",
        key = "time_8_mode_read",
        value_function = value_function_time_slot_8_reverse_mode,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 8 Active (read)",
        key = "time_8_enabled_read",
        value_function = value_function_time_slot_8_reverse_enabled,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 8 End (read)",
        key = "time_8_end_read",
        register = 3057,
        scale = value_function_growatt_gen4time,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),    
    GrowattModbusSensorEntityDescription(
        name = "Time 9 Begin (read)",
        key = "time_9_begin_read",
        value_function = value_function_time_slot_9_reverse_begin,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 9 Mode (read)",
        key = "time_9_mode_read",
        value_function = value_function_time_slot_9_reverse_mode,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),  
    GrowattModbusSensorEntityDescription(
        name = "Time 9 Active (read)",
        key = "time_9_enabled_read",
        value_function = value_function_time_slot_9_reverse_enabled,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Time 9 End (read)",
        key = "time_9_end_read",
        register = 3059,
        scale = value_function_growatt_gen4time,
        allowedtypes = GEN4 | HYBRID,
        entity_registry_enabled_default = False,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    
    ############ NEW entities TEST #######
    ######### NEW Test #############

    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 Combined Current",
        key = "bms_1_module_2_combined_current",
        value_function = value_function_combined_bms_current,
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        allowedtypes = GEN4,
        icon = "mdi:battery",       
    ),       
       
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 Warning Code",
        key = "bms_1_module_2_warning_code",
        register = 5138,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 Warning Code",
        key = "bms_1_module_3_warning_code",
        register = 5178,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 Warning Code",
        key = "bms_1_module_4_warning_code",
        register = 5218,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 Warning Code",
        key = "bms_1_module_5_warning_code",
        register = 5258,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 Warning Code",
        key = "bms_1_module_6_warning_code",
        register = 5298,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Warning Code",
        key = "bms_2_module_1_warning_code",
        register = 5338,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 Warning Code",
        key = "bms_2_module_2_warning_code",
        register = 5378,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 Warning Code",
        key = "bms_2_module_3_warning_code",
        register = 5418,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 Warning Code",
        key = "bms_2_module_4_warning_code",
        register = 5458,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 Warning Code",
        key = "bms_2_module_5_warning_code",
        register = 5498,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 Warning Code",
        key = "bms_2_module_6_warning_code",
        register = 5538,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 1 Status",
        key = "bms_1_module_1_status",
        register = 5880,
        register_type = REG_HOLDING,
        unit = REGISTER_U16,
        scale = value_function_module_status,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 1 SoC",
        key = "bms_1_module_1_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5881,
        register_type = REG_HOLDING, ### HOLDING!!!
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 1 SoH",
        key = "bms_1_module_1_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5882,
        register_type = REG_HOLDING, ### HOLDING!!!
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 1 Volt",
        key = "bms_1_module_1_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5883,
        register_type = REG_HOLDING, ### HOLDING!!!
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 1 Total Throughput",
        key = "bms_1_module_1_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5887, #maybe 5886 and U32
        register_type = REG_HOLDING, ### HOLDING!!!
        unit = REGISTER_U16,# maybe U32 but then change register to 5886
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 1 Charge Cycles",
        key = "bms_1_module_1_charge_cycles",
        register = 5908, 
        register_type = REG_HOLDING, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 Status",
        key = "bms_1_module_2_status",
        register = 5120,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 SoC",
        key = "bms_1_module_2_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5121,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 SoH",
        key = "bms_1_module_2_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5122,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 Volt",
        key = "bms_1_module_2_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5123,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 Amp",
        key = "bms_1_module_2_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5124,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 Watt",
        key = "bms_1_module_2_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5125,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),      
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 Total Throughput",
        key = "bms_1_module_2_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5127, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),   
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 Charge Cycle",
        key = "bms_1_module_2_charge_cycle",
        register = 5148, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 Status",
        key = "bms_1_module_3_status",
        register = 5160,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status, 
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 SoC",
        key = "bms_1_module_3_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5161,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 SoH",
        key = "bms_1_module_3_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5162,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 Volt",
        key = "bms_1_module_3_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5163,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 Amp",
        key = "bms_1_module_3_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5164,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 Watt",
        key = "bms_1_module_3_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5165,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 Total Throughput",
        key = "bms_1_module_3_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5167, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),   
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 Charge Cycle",
        key = "bms_1_module_3_charge_cycle",
        register = 5188, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 Status",
        key = "bms_1_module_4_status",
        register = 5200,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 SoC",
        key = "bms_1_module_4_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5201,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 SoH",
        key = "bms_1_module_4_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5202,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 Volt",
        key = "bms_1_module_4_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5203,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 Amp",
        key = "bms_1_module_4_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5204,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 Watt",
        key = "bms_1_module_4_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5205,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 Total Throughput",
        key = "bms_1_module_4_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5207,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 Charge Cycle",
        key = "bms_1_module_4_charge_cycle",
        register = 5228, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 Status",
        key = "bms_1_module_5_status",
        register = 5240,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 SoC",
        key = "bms_1_module_5_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5241,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 SoH",
        key = "bms_1_module_5_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5242,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 Volt",
        key = "bms_1_module_5_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5243,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 Amp",
        key = "bms_1_module_5_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5244,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 Watt",
        key = "bms_1_module_5_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5245,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 Total Throughput",
        key = "bms_1_module_5_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5247,  
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 Charge Cycle",
        key = "bms_1_module_5_charge_cycle",
        register = 5268, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 Status",
        key = "bms_1_module_6_status",
        register = 5280,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 SoC",
        key = "bms_1_module_6_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5281, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 SoH",
        key = "bms_1_module_6_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5282,    
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 Volt",
        key = "bms_1_module_6_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5283,  
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 Amp",
        key = "bms_1_module_6_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5284,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
     GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 Watt",
        key = "bms_1_module_6_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5285,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 Total Throughput",
        key = "bms_1_module_6_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5287,   
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 Charge Cycle",
        key = "bms_1_module_6_charge_cycle",
        register = 5308, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Status",
        key = "bms_2_module_1_status",
        register = 5320,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 SoC",
        key = "bms_2_module_1_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5321,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 SoH",
        key = "bms_2_module_1_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5322,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Volt",
        key = "bms_2_module_1_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5323,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Amp",
        key = "bms_2_module_1_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5324,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Watt",
        key = "bms_2_module_1_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5325,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Total Throughput",
        key = "bms_2_module_1_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5327, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Max Cell Temp",
        key = "bms_2_module_1_max_cell_temp",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5330, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Min Cell Temp",
        key = "bms_2_module_1_min_cell_temp",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5331, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Charge Cycle",
        key = "bms_2_module_1_charge_cycle",
        register = 5348, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 Status",
        key = "bms_2_module_2_status",
        register = 5360,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status,  
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 SoC",
        key = "bms_2_module_2_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5361,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 SoH",
        key = "bms_2_module_2_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5362,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 Volt",
        key = "bms_2_module_2_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5363,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 Amp",
        key = "bms_2_module_2_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5364,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 Watt",
        key = "bms_2_module_2_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5365,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),      
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 Total Throughput",
        key = "bms_2_module_2_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5367, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 Charge Cycle",
        key = "bms_2_module_2_charge_cycle",
        register = 5388, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),   
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 Status",
        key = "bms_2_module_3_status",
        register = 5400,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status, 
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 SoC",
        key = "bms_2_module_3_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5401,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 SoH",
        key = "bms_2_module_3_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5402,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 Volt",
        key = "bms_2_module_3_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5403,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 Amp",
        key = "bms_2_module_3_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5404,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 Watt",
        key = "bms_2_module_3_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5405,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),      
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 Total Throughput",
        key = "bms_2_module_3_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5407, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 Charge Cycle",
        key = "bms_2_module_3_charge_cycle",
        register = 5428, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 Status",
        key = "bms_2_module_4_status",
        register = 5440,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status,  
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 SoC",
        key = "bms_2_module_4_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5441,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 SoH",
        key = "bms_2_module_4_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5442,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 Volt",
        key = "bms_2_module_4_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5443,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 Amp",
        key = "bms_2_module_4_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5444,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 Watt",
        key = "bms_2_module_4_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5445,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),     
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 Total Throughput",
        key = "bms_2_module_4_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5447, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 Charge Cycle",
        key = "bms_2_module_4_charge_cycle",
        register = 5468, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 Status",
        key = "bms_2_module_5_status",
        register = 5480,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 SoC",
        key = "bms_2_module_5_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5481,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 SoH",
        key = "bms_2_module_5_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5482,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 Volt",
        key = "bms_2_module_5_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5483,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 Amp",
        key = "bms_2_module_5_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5484,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 Watt",
        key = "bms_2_module_5_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5485,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 Total Throughput",
        key = "bms_2_module_5_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5487, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 Charge Cycle",
        key = "bms_2_module_5_charge_cycle",
        register = 5508, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 Status",
        key = "bms_2_module_6_status",
        register = 5520,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = value_function_module_status,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 SoC",
        key = "bms_2_module_6_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5521,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.00390625,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 SoH",
        key = "bms_2_module_6_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5522,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),        
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 Volt",
        key = "bms_2_module_6_volt",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5523,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 Amp",
        key = "bms_2_module_6_amp",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5524,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 Watt",
        key = "bms_2_module_6_watt",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5525,
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),  
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 Total Throughput",
        key = "bms_2_module_6_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5527, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 Charge Cycle",
        key = "bms_2_module_6_charge_cycle",
        register = 5548, 
        register_type = REG_INPUT, 
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ), 
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module Count",
        key = "bms_2_module_count",
        register = 5076, 
        register_type = REG_HOLDING, ### HOLDING!!!
        unit = REGISTER_U16,
        scale = 0.02,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-sync",
    ),
	
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Serial Number",
        key = "bms_2_serialnumber",
        register = 5042,
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Monitoring Version",
        key = "bms_2_monitoring_version",
        register = 5051,
        unit = REGISTER_STR,
        wordcount = 2,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Monitoring Version",
        key = "bms_1_monitoring_version",
        register = 5011,
        unit = REGISTER_STR,
        wordcount = 2,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 1 Serial Number",
        key = "bms_1_module_1_serialnumber",
        register = 5400,
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 2 Serial Number",
        key = "bms_1_module_2_serialnumber",
        register = 5440,
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 3 Serial Number",
        key = "bms_1_module_3_serialnumber",
        register = 5480,
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 4 Serial Number",
        key = "bms_1_module_4_serialnumber",
        register = 5520,
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 5 Serial Number",
        key = "bms_1_module_5_serialnumber",
        register = 5560,
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Module 6 Serial Number",
        key = "bms_1_module_6_serialnumber",
        register = 5600,
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Serial Number",
        key = "bms_1_serialnumber",
        register = 3087,
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 1 Serial Number", 
        key = "bms_2_module_1_serialnumber", 
        register = 5640, 
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 2 Serial Number", 
        key = "bms_2_module_2_serialnumber", 
        register = 5680, 
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 3 Serial Number", 
        key = "bms_2_module_3_serialnumber", 
        register = 5720, 
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 4 Serial Number", 
        key = "bms_2_module_4_serialnumber", 
        register = 5760, 
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 5 Serial Number", 
        key = "bms_2_module_5_serialnumber", 
        register = 5800, 
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Module 6 Serial Number", 
        key = "bms_2_module_6_serialnumber", 
        register = 5840, 
        unit = REGISTER_STR,
        wordcount = 8,
        entity_registry_enabled_default = False,
        allowedtypes = GEN4,
        entity_category = EntityCategory.DIAGNOSTIC,
        icon = "mdi:information",
    ),
   
    
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 SoC",
        key = "bms_1_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5777,
        register_type = REG_INPUT,
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 SoH",
        key = "bms_1_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5778,
        register_type = REG_INPUT,
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Total Throughput",
        key = "bms_1_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5769,  # maybe 5768 and U32
        register_type = REG_INPUT, 
        unit = REGISTER_U16, ## maybe U32 if reg is 5768
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Charge Power",
        key = "bms_1_charge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3331,  
        register_type = REG_INPUT, 
        unit = REGISTER_U32, 
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 1 Discharge Power",
        key = "bms_1_discharge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3334,  
        register_type = REG_INPUT, 
        unit = REGISTER_U32, 
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 SoC",
        key = "bms_2_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5877,
        register_type = REG_INPUT,
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-50",
    ),       
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 SoH",
        key = "bms_2_soh",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5878,
        register_type = REG_INPUT,
        unit = REGISTER_U16,
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery-heart",
    ),      
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Total Throughput",
        key = "bms_2_tp",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 5869,  # maybe 5868 and U32
        register_type = REG_INPUT, 
        unit = REGISTER_U16, ## maybe U32 if reg is 5868
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Charge Power",
        key = "bms_2_charge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3336,  
        register_type = REG_INPUT, 
        unit = REGISTER_U32, 
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),
    GrowattModbusSensorEntityDescription(
        name = "BMS 2 Discharge Power",
        key = "bms_2_discharge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3338,  
        register_type = REG_INPUT, 
        unit = REGISTER_U32, 
        scale = 0.1,        
        allowedtypes = GEN4,
        entity_registry_enabled_default = False,
        icon = "mdi:battery",
    ),    
    
    
    
    
    #####
    #
    # SPF
    #
    #####
    GrowattModbusSensorEntityDescription(
        name = "Run Mode",
        key = "run_mode",
        register = 0,
        scale = { 0: "Standby",
                  1: "PV & Grid Discharge",
                  2: "Discharge",
                  3: "Fault",
                  4: "Flash",
                  5: "PV Charge",
                  6: "AC Charge",
                  7: "Combine Charge",
                  8: "Combine Charge & Bypass",
                  9: "PV Charge & Bypass",
                 10: "AC Charge & Bypass",
                 11: "Bypass",
                 12: "PV Charge & Discharge", },
        register_type = REG_INPUT,
        allowedtypes = SPF,
        icon = "mdi:run",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 1",
        key = "pv_voltage_1",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 1,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Voltage 2",
        key = "pv_voltage_2",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 2,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 1",
        key = "pv_power_1",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 3,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Power 2",
        key = "pv_power_2",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 5,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
        icon = "mdi:solar-power-variant",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 1",
        key = "pv_current_1",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 7,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "PV Current 2",
        key = "pv_current_2",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 8,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
        icon = "mdi:current-dc",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Active Power",
        key = "output_active_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 9,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Apparent Power",
        key = "output_apparent_power",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 11,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Charge Power",
        key = "ac_charge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 13,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Charge Apparent Power",
        key = "ac_charge_apparent_power",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 15,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Voltage",
        key = "battery_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 17,
        register_type = REG_INPUT,
        scale = 0.01,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery SOC",
        key = "battery_soc",
        native_unit_of_measurement = PERCENTAGE,
        device_class = SensorDeviceClass.BATTERY,
        register = 18,
        register_type = REG_INPUT,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Voltage",
        key = "grid_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 20,
        scale = 0.1,
        register_type = REG_INPUT,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Grid Frequency",
        key = "grid_frequency",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        device_class = SensorDeviceClass.FREQUENCY,
        register = 21,
        register_type = REG_INPUT,
        scale = 0.01,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Voltage",
        key = "output_voltage",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 22,
        scale = 0.1,
        register_type = REG_INPUT,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Frequency",
        key = "output_frequency",
        native_unit_of_measurement = UnitOfFrequency.HERTZ,
        device_class = SensorDeviceClass.FREQUENCY,
        register = 23,
        register_type = REG_INPUT,
        scale = 0.01,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Voltage DC",
        key = "output_voltage_dc",
        native_unit_of_measurement = UnitOfElectricPotential.VOLT,
        device_class = SensorDeviceClass.VOLTAGE,
        register = 24,
        scale = 0.1,
        register_type = REG_INPUT,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Inverter Temperature",
        key = "inverter_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 25,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "DC-DC Temperature",
        key = "dcdc_temperature",
        native_unit_of_measurement = UnitOfTemperature.CELSIUS,
        device_class = SensorDeviceClass.TEMPERATURE,
        state_class = SensorStateClass.MEASUREMENT,
        register = 26,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
        entity_category = EntityCategory.DIAGNOSTIC,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Inverter Load",
        key = "inverter_load",
        native_unit_of_measurement = PERCENTAGE,
        register = 27,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Work Time",
        key = "total_work_time",
        native_unit_of_measurement = UnitOfTime.SECONDS,
        device_class = SensorDeviceClass.DURATION,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 30,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.5,
        rounding = 1,
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
        icon = "mdi:timelapse",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Output Current",
        key = "output_current",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 34,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Inverter Current",
        key = "inverter_current",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 35,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Input Power",
        key = "ac_input_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 36,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Input Apparent Power",
        key = "ac_input_apparent_power",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 38,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Fault Code",
        key = "fault_code",
        register = 42,
        register_type = REG_INPUT,
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Warning Code",
        key = "warning_code",
        register = 43,
        register_type = REG_INPUT,
        allowedtypes = SPF,
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Constant Power OK",
        key = "constant_power_ok",
        register = 47,
        scale = { 0: "Not OK",
                  1: "OK", },
        register_type = REG_INPUT,
        allowedtypes = SPF,
        icon = "mdi:information",
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Solar Energy PV1",
        key = "today_s_solar_energy_pv1",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 48,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Solar Energy PV1",
        key = "total_solar_energy_pv1",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 50,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Solar Energy PV2",
        key = "today_s_solar_energy_pv2",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 52,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Solar Energy PV2",
        key = "total_solar_energy_pv2",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        icon = "mdi:solar-power",
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 54,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's AC Charge",
        key = "today_s_ac_charge",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 56,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total AC Charge",
        key = "total_ac_charge",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 58,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's Battery Discharge",
        key = "today_s_battery_discharge",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 60,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total Battery Discharge",
        key = "total_battery_discharge",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 62,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Today's AC Discharge",
        key = "today_s_ac_discharge",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 64,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Total AC Discharge",
        key = "total_ac_discharge",
        native_unit_of_measurement = UnitOfEnergy.KILO_WATT_HOUR,
        device_class = SensorDeviceClass.ENERGY,
        state_class = SensorStateClass.TOTAL_INCREASING,
        register = 66,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 2,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Battery Charge",
        key = "ac_battery_charge",
        native_unit_of_measurement = UnitOfElectricCurrent.AMPERE,
        device_class = SensorDeviceClass.CURRENT,
        register = 68,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Discharge Power",
        key = "ac_discharge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 69,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "AC Discharge Apparent Power",
        key = "ac_discharge_apparent_power",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 71,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Discharge Power",
        key = "battery_discharge_power",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 73,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Discharge Apparent Power",
        key = "battery_discharge_apparent_power",
        native_unit_of_measurement = UnitOfApparentPower.VOLT_AMPERE,
        device_class = SensorDeviceClass.APPARENT_POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 75,
        register_type = REG_INPUT,
        unit = REGISTER_U32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Power Charge",
        key = "battery_power_charge",
        native_unit_of_measurement = UnitOfPower.WATT,
        device_class = SensorDeviceClass.POWER,
        state_class = SensorStateClass.MEASUREMENT,
        register = 77,
        register_type = REG_INPUT,
        unit = REGISTER_S32,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
        icon = "mdi:battery-charging",
    ),
    GrowattModbusSensorEntityDescription(
        name = "Battery Over Charge",
        key = "battery_over_charge",
        register = 80,
        scale = { 0: "Not Over Charge",
                  1: "Over Charge", },
        register_type = REG_INPUT,
        allowedtypes = SPF,
        icon = "mdi:information",
        entity_registry_enabled_default = False,
    ),
    GrowattModbusSensorEntityDescription(
        name = "MPPT Fan Speed",
        key = "mppt_fan_speed",
        native_unit_of_measurement = PERCENTAGE,
        register = 81,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
    GrowattModbusSensorEntityDescription(
        name = "Inverter Fan Speed",
        key = "inverter_fan_speed",
        native_unit_of_measurement = PERCENTAGE,
        register = 82,
        register_type = REG_INPUT,
        scale = 0.1,
        rounding = 1,
        allowedtypes = SPF,
    ),
]

# ============================ plugin declaration =================================================

@dataclass
class growatt_plugin(plugin_base):

    async def async_determineInverterType(self, hub, configdict):
        _LOGGER.info(f"{hub.name}: trying to determine inverter type")
        seriesnumber = await async_read_serialnr(hub, 9)
        if not seriesnumber:
            _LOGGER.info(f"{hub.name}: trying alternative location")
            seriesnumber = await async_read_serialnr(hub, 3001)
        if not seriesnumber:
            _LOGGER.error(f"{hub.name}: cannot find firmware version, even not for other Inverter")
            seriesnumber = "unknown"

        ### Current mapping assumptions for Growatt
        # TL3-SL = GEN
        # TL3-X (MAX, MID, MAC & MOD) = GEN2
        # Storage (MIX, SPA, SPH) = GEN3
        # TL-X, TL-XH, TL-XHUS (MIN) = GEN4
        # TL3-XH (MOD) = GEN4
        # TL3-XH (MID) = GEN4
        # SPF = SPF 
        
        # derive invertertype from seriesnumber
        if seriesnumber.startswith('dha'):  invertertype = PV | GEN | X3 # PV TL3-SL 10-22kW #1067
        #elif seriesnumber.startswith('xyz'):  invertertype = PV | GEN | X1 # Possible Single Phase version of above
        #elif seriesnumber.startswith('xyz'):  invertertype = PV | GEN | X3 | MPPT3 # Possible 3xMMPT version of above
        elif seriesnumber.startswith('DL1'):  invertertype = PV | GEN2 | X3 # PV TL3-X 15kW 3Phase (MOD)
        elif seriesnumber.startswith('DM1'):  invertertype = PV | GEN2 | X3 | MPPT4 # PV TL3-X 35kW 3Phase (MID)
        elif seriesnumber.startswith('AH1'):  invertertype = PV | GEN3 | X1 # Hybrid SPH 4kW - 10kW
        elif seriesnumber.startswith('AJ1'):  invertertype = PV | GEN4 | X1 # PV TL-X 2.5kW - 6kW (MIN)
        elif seriesnumber.startswith('GH1'):  invertertype = PV | GEN4 | X1 # PV TL-X 2.5kW - 6kW (MIN)
        elif seriesnumber.startswith('AM1'):  invertertype = PV | GEN4 | X1 | MPPT3 # PV TL-X2 7kW - 120kW (MIN)
        #elif seriesnumber.startswith('MID'):  invertertype = PV | GEN4 | X3 | MPPT3 # PV X3 2MPPT 15-25kW, 3/4 MPPT 25-40kW & 30-50kW
        #elif seriesnumber.startswith('MAC'):  invertertype = PV | GEN4 | X3 # PV X3 3MPPT 50-70kW
        #elif seriesnumber.startswith('MAX'):  invertertype = PV | GEN4 | X3 # PV X3 6/7MPPT 50-80kW, 8 MPPT 100-150kW & 10 MPPT 100-150kW
        elif seriesnumber.startswith('RAA'):  invertertype = HYBRID | GEN3 | X1 # Hybrid SPH 3kW - 6kW
        elif seriesnumber.startswith('RA1'):  invertertype = HYBRID | GEN3 | X1 # Hybrid SPH 3kW - 6kW
        elif seriesnumber.startswith('SPH'):  invertertype = HYBRID | GEN3 | X3 # Hybrid SPH 4kW - 10kW
        elif seriesnumber.startswith('YA1'):  invertertype = HYBRID | GEN3 | X3 # Hybrid SPH 4kW - 10kW 3P TL UP
        elif seriesnumber.startswith('AL1'):  invertertype = HYBRID | GEN4 | X1 # Hybrid TL-XH 2.5kW - 6kW (MIN)
        elif seriesnumber.startswith('DN1'):  invertertype = HYBRID | GEN4 | X3 # Hybrid TL3-XH (BP) 3kW - 10kW (MOD), 11kW - 30kW (MID)  
        elif seriesnumber.startswith('V'):  invertertype = HYBRID | GEN4 | X3 # Hybrid TL3-XH 3kW - 10kW (MOD)
        elif seriesnumber.startswith('067'):  invertertype = HYBRID | SPF | X1 # Hybrid SPF 5kW
        elif seriesnumber.startswith('500'):  invertertype = HYBRID | SPF | X1 # Hybrid SPF 5kW
        #elif seriesnumber.startswith('SPA'):  invertertype = AC | GEN2 | X3 # AC SPA 4kW - 10kW Could be based SPF?
        
        else:
            invertertype = 0
            _LOGGER.error(f"unrecognized {hub.name} inverter type - firmware version : {seriesnumber}")

        if invertertype > 0:
            read_eps = configdict.get(CONF_READ_EPS, DEFAULT_READ_EPS)
            read_dcb = configdict.get(CONF_READ_DCB, DEFAULT_READ_DCB)
            if read_eps: invertertype = invertertype | EPS
            if read_dcb: invertertype = invertertype | DCB

        return invertertype

    def matchInverterWithMask (self, inverterspec, entitymask, serialnumber = 'not relevant', blacklist = None):
        # returns true if the entity needs to be created for an inverter
        genmatch = ((inverterspec & entitymask & ALL_GEN_GROUP)  != 0) or (entitymask & ALL_GEN_GROUP  == 0)
        xmatch   = ((inverterspec & entitymask & ALL_X_GROUP)    != 0) or (entitymask & ALL_X_GROUP    == 0)
        hybmatch = ((inverterspec & entitymask & ALL_TYPE_GROUP) != 0) or (entitymask & ALL_TYPE_GROUP == 0)
        epsmatch = ((inverterspec & entitymask & ALL_EPS_GROUP)  != 0) or (entitymask & ALL_EPS_GROUP  == 0)
        dcbmatch = ((inverterspec & entitymask & ALL_DCB_GROUP)  != 0) or (entitymask & ALL_DCB_GROUP  == 0)
        mpptmatch = ((inverterspec & entitymask & ALL_MPPT_GROUP)  != 0) or (entitymask & ALL_MPPT_GROUP  == 0)
        blacklisted = False
        if blacklist:
            for start in blacklist:
                if serialnumber.startswith(start) : blacklisted = True
        return (genmatch and xmatch and hybmatch and epsmatch and dcbmatch and mpptmatch) and not blacklisted

plugin_instance = growatt_plugin(
    plugin_name = 'Growatt',
    plugin_manufacturer = 'Growatt New Energy',
    SENSOR_TYPES = SENSOR_TYPES,
    NUMBER_TYPES = NUMBER_TYPES,
    BUTTON_TYPES = BUTTON_TYPES,
    SELECT_TYPES = SELECT_TYPES,
    SWITCH_TYPES = [],
    block_size = 100,
    order16 = Endian.BIG,
    order32 = Endian.BIG,
    auto_block_ignore_readerror = True
    )
